<!-- 626b9a46-6dd9-4d70-9535-877619824f4d 576071c1-3a96-4755-924f-0fcafa9834c0 -->
# Анализ тестов без Allure аннотаций

## Цель

Составить полный список тестов, которые не имеют полного набора Allure аннотаций для каждого отдельного теста.

## Обязательные Allure аннотации

Согласно правилам из `testing-rules.mdc`, каждый тест должен иметь:

- `@allure.epic` - на уровне класса (уже есть у большинства)
- `@allure.feature` - на уровне класса (уже есть у большинства)
- `@allure.title` - для каждого теста (отсутствует у многих) **НА РУССКОМ ЯЗЫКЕ**
- `@allure.description` - для каждого теста (отсутствует у многих)
- `@allure.severity` - для каждого теста (отсутствует у многих)
- `@allure.tag` - для каждого теста (отсутствует у многих)

## Дополнительные требования

### 1. Русские названия тестов

- Все `@allure.title` должны быть на русском языке
- Названия должны быть понятными и отражать суть теста
- Пример: `@allure.title("Регистрация нового пользователя")` вместо `@allure.title("Test user registration")`

### 2. Декораторы на уровне класса

- Все тесты должны находиться в классах с декораторами `@allure.epic` и `@allure.feature`
- Функции-тесты без класса должны иметь декораторы перед функцией
- Убедиться, что все тесты находятся в рамках соответствующих декораторов

### 3. Соответствие правилам testing-rules.mdc

- Все тесты должны соответствовать правилам из `testing-rules.mdc`
- Проверить правильность выбора `@allure.epic` и `@allure.feature` согласно таблицам в правилах
- Убедиться, что структура `@allure.description` соответствует требованиям (разделы: "Что проверяется", "Тестовые данные", "Ожидаемый результат")
- Проверить правильность выбора `@allure.severity` (CRITICAL, NORMAL, MINOR)
- Убедиться, что теги `@allure.tag` соответствуют требованиям (обязательные: тип теста, дополнительные: функциональность, компонент)

## Категории тестов без аннотаций

### 1. Тесты с @allure.epic и @allure.feature, но без аннотаций для методов

#### tests/unit/test_database/

- `test_user_operations.py` - 6 тестов без аннотаций
- `test_key_operations.py` - 8 тестов без аннотаций
- `test_promo_code_operations.py` - 7 тестов без аннотаций
- `test_referral_operations.py` - 5 тестов без аннотаций
- `test_transaction_operations.py` - 4 теста без аннотаций
- `test_trial_operations.py` - 5 тестов (4 без аннотаций, 1 с частичными)
- `test_key_numbering.py` - 6 тестов (1 с полными аннотациями, 5 без)
- `test_host_operations.py` - 5 тестов без аннотаций
- `test_cabinet_links.py` - 5 тестов без аннотаций
- `test_plan_display_mode.py` - 11 тестов (есть @allure.story и @allure.description, но нет @allure.title, @allure.severity, @allure.tag)
- `test_locks.py` - 10+ тестов без аннотаций
- `test_notifications.py` - 7+ тестов без аннотаций

#### tests/unit/test_bot/

- `test_handlers.py` - 3 теста без аннотаций
- `test_keyboard_generation.py` - 7+ тестов без аннотаций
- `test_promo_code_logic.py` - 4+ тестов без аннотаций

#### tests/unit/test_webhook_server/

- `test_auth.py` - 4+ тестов без аннотаций
- `test_dashboard.py` - 3+ тестов без аннотаций
- `test_keys.py` - тесты без аннотаций (требует проверки)
- `test_promo_codes.py` - тесты без аннотаций (требует проверки)
- `test_settings.py` - тесты без аннотаций (требует проверки)
- `test_support.py` - тесты без аннотаций (требует проверки)
- `test_wiki.py` - тесты без аннотаций (требует проверки)
- `test_monitoring.py` - тесты без аннотаций (требует проверки)
- `test_filters.py` - тесты без аннотаций (требует проверки)
- `test_notifications.py` - тесты без аннотаций (требует проверки)
- `test_documents.py` - тесты без аннотаций (требует проверки)
- `test_instructions.py` - тесты без аннотаций (требует проверки)
- `test_ton_connect.py` - тесты без аннотаций (требует проверки)

#### tests/unit/test_utils/

- `test_deeplink.py` - тесты без аннотаций (требует проверки)
- `test_timezone_utils.py` - тесты без аннотаций (unittest.TestCase, не требует декораторов)

#### tests/unit/test_modules/

- `test_xui_api.py` - тесты без аннотаций (требует проверки)

#### tests/unit/test_security/

- `test_validators.py` - тесты без аннотаций (требует проверки)

#### tests/unit/test_user_cabinet/

- `test_cabinet.py` - тесты без аннотаций (требует проверки)

### 2. Интеграционные тесты (требуют проверки)

- `tests/integration/` - большинство файлов имеют аннотации, но требуют проверки на полноту

### 3. E2E тесты (требуют проверки)

- `tests/e2e/` - большинство файлов имеют аннотации, но требуют проверки на полноту

## Методология проверки

1. Использовать grep для поиска всех тестовых функций: `def test_`
2. Проверить наличие аннотаций перед каждой функцией теста
3. Составить список файлов и конкретных тестов без аннотаций
4. Сгруппировать по категориям для удобства

## Результат анализа

После выполнения анализа будет составлен полный список тестов без Allure аннотаций с указанием:

- Путь к файлу
- Название теста
- Какие аннотации отсутствуют
- Рекомендуемые значения для аннотаций