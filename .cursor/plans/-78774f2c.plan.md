<!-- 78774f2c-2469-4820-9f1e-6794ebe97b22 88557fdd-132b-4a57-8d79-3e9e5fffffae -->
# –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

## –¶–µ–ª—å

1. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å fallback-—Ç–µ–∫—Å—Ç—ã –≤ `get_purchase_success_text()` —Å —Ç–µ–∫—É—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
2. –î–æ–±–∞–≤–∏—Ç—å —à–∞–±–ª–æ–Ω—ã "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—é—á–µ" –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å `get_key_info_text()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –∏–∑ –ë–î

## –ó–∞–¥–∞—á–∞ 1: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è fallback-—Ç–µ–∫—Å—Ç–æ–≤ –ø–æ–∫—É–ø–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

### –§–∞–π–ª: `src/shop_bot/config.py`

### –§—É–Ω–∫—Ü–∏—è: `get_purchase_success_text()` (—Å—Ç—Ä–æ–∫–∏ 325-513)

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** Fallback-—Ç–µ–∫—Å—Ç—ã –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `\n` –∏ –ø—Ä–æ–±–µ–ª—ã –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫, –∞ —à–∞–±–ª–æ–Ω—ã –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `<br>` –∏ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö 5 —Ä–µ–∂–∏–º–æ–≤:**

1. **–†–µ–∂–∏–º `key` (—Å—Ç—Ä–æ–∫–∞ 470-479):** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞:
`üéâ <b>–í–∞—à –∫–ª—é—á #{key_number}{trial_suffix} {action_text}!</b><br><br>‚è≥ <b>–û–Ω –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥–æ:</b> {expiry_formatted}<br><br>‚¨áÔ∏è <b>–ù–ò–ñ–ï –í–ê–® –ö–õ–Æ–ß</b> ‚¨áÔ∏è<br>------------------------------------------------------------------------<br><code>{connection_string}</code><br>------------------------------------------------------------------------<br><blockquote>‚ÅâÔ∏è –ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É [‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞]</blockquote><br>{cabinet_text}{fallback_text}`

2. **–†–µ–∂–∏–º `subscription` (—Å—Ç—Ä–æ–∫–∞ 444-453):** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞:
`üéâ <b>–í–∞—à –∫–ª—é—á #{key_number}{trial_suffix} {action_text}!</b><br><br>‚è≥ <b>–û–Ω –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥–æ:</b> {expiry_formatted}<br><br>‚¨áÔ∏è <b>–í–ê–®–ê –ü–û–î–ü–ò–°–ö–ê</b> ‚¨áÔ∏è<br>------------------------------------------------------------------------<br>{subscription_link}<br>------------------------------------------------------------------------<br><blockquote>‚ÅâÔ∏è –ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É [‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞]</blockquote><br>{cabinet_text}{fallback_text}`

3. **–†–µ–∂–∏–º `both` (—Å—Ç—Ä–æ–∫–∞ 455-468):** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞:
`üéâ <b>–í–∞—à –∫–ª—é—á #{key_number}{trial_suffix} {action_text}!</b><br><br>‚è≥ <b>–û–Ω –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥–æ:</b> {expiry_formatted}<br><br>‚¨áÔ∏è <b>–ù–ò–ñ–ï –í–ê–® –ö–õ–Æ–ß</b> ‚¨áÔ∏è<br>------------------------------------------------------------------------<br><code>{connection_string}</code><br>------------------------------------------------------------------------<br><br>‚¨áÔ∏è <b>–í–ê–®–ê –ü–û–î–ü–ò–°–ö–ê</b> ‚¨áÔ∏è<br>------------------------------------------------------------------------<br>{subscription_link}<br>------------------------------------------------------------------------<br><blockquote>‚ÅâÔ∏è –ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É [‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞]</blockquote><br>{cabinet_text}{fallback_text}`

4. **–†–µ–∂–∏–º `cabinet` (—Å—Ç—Ä–æ–∫–∞ 417-428):** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞:
`üéâ <b>–í–∞—à –∫–ª—é—á #{key_number}{trial_suffix} {action_text}!</b><br><br>‚è≥ <b>–û–Ω –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥–æ:</b> {expiry_formatted}<br><br>‚¨áÔ∏è <b>–í–ê–® –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢</b> ‚¨áÔ∏è<br>------------------------------------------------------------------------<br><a href="{cabinet_url}">{cabinet_url}</a><br>------------------------------------------------------------------------<br><blockquote>‚ÅâÔ∏è –ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É [‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞]</blockquote>`

5. **–†–µ–∂–∏–º `cabinet_subscription` (—Å—Ç—Ä–æ–∫–∞ 430-441):** –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞:
`üéâ <b>–í–∞—à –∫–ª—é—á #{key_number}{trial_suffix} {action_text}!</b><br><br>‚è≥ <b>–û–Ω –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –¥–æ:</b> {expiry_formatted}<br><br>‚¨áÔ∏è <b>–í–ê–® –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢</b> ‚¨áÔ∏è<br>------------------------------------------------------------------------<br><a href="{cabinet_url}">{cabinet_url}</a><br>------------------------------------------------------------------------<br><blockquote>‚ÅâÔ∏è –ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN, –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É [‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞]</blockquote>`

## –ó–∞–¥–∞—á–∞ 1.1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–∞—Ä–∏—Ñ–µ

### –§–∞–π–ª: `src/shop_bot/config.py`

**–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `format_tariff_info()`:**

- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç: `host_name`, `plan_name`, `price`, `is_trial`, `status`, `expiry_date`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:
- `status_icon` - `‚úÖ` –∏–ª–∏ `‚ùå` (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç—É—Å–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è)
- `host_flag` - –ø–µ—Ä–≤—ã–µ 2 —Å–∏–º–≤–æ–ª–∞ `host_name` –∏–ª–∏ `üåê`
- `tariff_name` - `TRIAL` –∏–ª–∏ `plan_name`
- `price_formatted` - —Ü–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `X‚ÇΩ` –∏–ª–∏ `0‚ÇΩ` –¥–ª—è —Ç—Ä–∏–∞–ª–∞
- `tariff_info` - –≥–æ—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ `{status_icon} {host_flag} | {tariff_name} | {price_formatted}`

**–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏:**

- `get_purchase_success_text()` - –¥–æ–±–∞–≤–∏—Ç—å `host_name`, `plan_name`, `price`, `status`
- `get_key_info_text()` - –¥–æ–±–∞–≤–∏—Ç—å `host_name`, `plan_name`, `price`, `status`

**–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `template_variables`:**

- –î–ª—è –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–æ–≤ –ø–æ–∫—É–ø–∫–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–ª—é—á–µ –¥–æ–±–∞–≤–∏—Ç—å: `status_icon`, `host_flag`, `tariff_name`, `price_formatted`, `tariff_info`

## –ó–∞–¥–∞—á–∞ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—é—á–µ"

### –§–∞–π–ª: `src/shop_bot/data_manager/database.py`

### –§—É–Ω–∫—Ü–∏—è: `initialize_db()` (—Å—Ç—Ä–æ–∫–∏ 2420-2456)

**–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é:**

–ü–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤ –ø–æ–∫—É–ø–∫–∏ (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 2443) –¥–æ–±–∞–≤–∏—Ç—å 5 –Ω–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤:

1. `key_info_key` - –¥–ª—è —Ä–µ–∂–∏–º–∞ "–ö–ª—é—á"
2. `key_info_subscription` - –¥–ª—è —Ä–µ–∂–∏–º–∞ "–ü–æ–¥–ø–∏—Å–∫–∞"  
3. `key_info_both` - –¥–ª—è —Ä–µ–∂–∏–º–∞ "–ö–ª—é—á + –ü–æ–¥–ø–∏—Å–∫–∞"
4. `key_info_cabinet` - –¥–ª—è —Ä–µ–∂–∏–º–∞ "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"
5. `key_info_cabinet_subscription` - –¥–ª—è —Ä–µ–∂–∏–º–∞ "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç + –ü–æ–¥–ø–∏—Å–∫–∞"

**–§–æ—Ä–º–∞—Ç —à–∞–±–ª–æ–Ω–æ–≤:**

- –ö–∞—Ç–µ–≥–æ—Ä–∏—è: `key_info`
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `key_number`, `trial_suffix`, `created_formatted`, `expiry_formatted`, `status_icon`, `status_text`, `connection_string`, `subscription_link`, `cabinet_url`
- –¢–µ–∫—Å—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π –ª–æ–≥–∏–∫–∏ `get_key_info_text()`, –Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `<br>` –≤–º–µ—Å—Ç–æ `\n`

### –§–∞–π–ª: `src/shop_bot/config.py`

### –§—É–Ω–∫—Ü–∏—è: `get_key_info_text()` (—Å—Ç—Ä–æ–∫–∏ 154-323)

**–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –∏–∑ –ë–î:**

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –ª–æ–≥–∏–∫—É –∫–∞–∫ fallback
2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ —á–µ—Ä–µ–∑ `get_message_text()` –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `get_purchase_success_text()`
3. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏:

- `key_number`, `trial_suffix`, `created_formatted`, `expiry_formatted`
- `status_icon`, `status_text`
- `connection_string`, `subscription_link`, `cabinet_url`

4. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å `template_key` –Ω–∞ –æ—Å–Ω–æ–≤–µ `provision_mode`:

- `key` ‚Üí `key_info_key`
- `subscription` ‚Üí `key_info_subscription`
- `both` ‚Üí `key_info_both`
- `cabinet` ‚Üí `key_info_cabinet`
- `cabinet_subscription` ‚Üí `key_info_cabinet_subscription`

5. –ï—Å–ª–∏ —à–∞–±–ª–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π fallback

## –ó–∞–¥–∞—á–∞ 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –§–∞–π–ª: `docs/reference/admin-panel/message-templates-reference.md`

–î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª "–®–∞–±–ª–æ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—é—á–µ¬ª" –ø–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–∞ "–®–∞–±–ª–æ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´–ü–æ–∫—É–ø–∫–∞¬ª" (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 116).

–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å —à–∞–±–ª–æ–Ω–∞–º–∏ –ø–æ–∫—É–ø–∫–∏, —É–∫–∞–∑–∞–≤:

- –ù–∞–∑–≤–∞–Ω–∏–µ, –∫–æ–¥, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ä–µ–∂–∏–º
- –¢–µ–∫—Å—Ç —à–∞–±–ª–æ–Ω–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
- –û–ø–∏—Å–∞–Ω–∏–µ

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ fallback-—Ç–µ–∫—Å—Ç—ã –ø–æ–∫—É–ø–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —à–∞–±–ª–æ–Ω–∞–º –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `get_key_info_text()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —à–∞–±–ª–æ–Ω—ã –∏–∑ –ë–î –ø—Ä–∏ –∏—Ö –Ω–∞–ª–∏—á–∏–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ fallback —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏/–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —à–∞–±–ª–æ–Ω–æ–≤
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é HTML-—Ç–µ–≥–æ–≤ –≤ –Ω–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–∞—Ö
6. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ä–µ–∂–∏–º—ã: key, subscription, both, cabinet, cabinet_subscription