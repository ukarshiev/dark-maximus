<!-- ce3d0242-d21d-43fd-9824-96eca54d26c1 3c470816-9509-4731-bbc8-c4b9efe9bd36 -->
# Исправление проблемы с автоматическим разлогиниванием

## Проблема

Сессии истекают через несколько минут, хотя настроено `PERMANENT_SESSION_LIFETIME = 30 дней`. Причина: не установлен `SESSION_COOKIE_MAX_AGE`, из-за чего cookie сессии истекает раньше времени.

## Решение

Добавить `SESSION_COOKIE_MAX_AGE` в функцию `init_flask_auth()` в `src/shop_bot/webhook_server/auth_utils.py`, чтобы cookie имел такой же срок жизни, как и сессия (30 дней = 2592000 секунд).

## Изменения

### 1. Обновление `src/shop_bot/webhook_server/auth_utils.py`

- Добавить `app.config['SESSION_COOKIE_MAX_AGE'] = timedelta(days=30)` после установки `PERMANENT_SESSION_LIFETIME`
- Это обеспечит, что cookie сессии будет иметь срок жизни 30 дней, соответствующий сроку жизни самой сессии

### 2. Обновление тестов

- Проверить, что тесты в `tests/unit/test_webhook_server/test_auth_utils.py` проверяют наличие `SESSION_COOKIE_MAX_AGE`
- При необходимости добавить проверку в тест `test_init_flask_auth_session_config`

### 3. Обновление документации

- Обновить `docs/security/security.md` с информацией о `SESSION_COOKIE_MAX_AGE`
- Обновить `CHANGELOG.md` с описанием исправления

## Файлы для изменения

- `src/shop_bot/webhook_server/auth_utils.py` - основное исправление
- `tests/unit/test_webhook_server/test_auth_utils.py` - обновление тестов (если нужно)
- `docs/security/security.md` - обновление документации
- `CHANGELOG.md` - запись об исправлении