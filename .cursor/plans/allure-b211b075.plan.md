<!-- b211b075-a5b1-4346-bf62-9d1dc4b38894 7316089d-cbb3-4463-8e6e-5fc7c27b4a8b -->
# План исследования и настройки Allure для отображения реальных данных

## Цель

Исследовать и настроить Allure так, чтобы он отображал реальные данные из терминала:

- 43 проваленных теста (сейчас показывает 14)
- 3 пропущенных теста (skipped)
- 374 теста с предупреждениями (warnings)
- Всего 449 тестов (сейчас показывает 412)

## Этапы исследования

### 1. Анализ файлов результатов в allure-results

- Подсчитать общее количество файлов `*-result.json` в allure-results
- Прочитать выборку файлов для анализа структуры (passed, failed, skipped)
- Проверить наличие полей `status`, `testCaseId`, `fullName`, `statusDetails` в результатах
- Проверить, записываются ли skipped тесты в файлы результатов

### 2. Подсчет статистики по статусам тестов

- Подсчитать количество тестов со статусом `passed` в allure-results
- Подсчитать количество тестов со статусом `failed` в allure-results
- Подсчитать количество тестов со статусом `skipped` в allure-results
- Подсчитать количество тестов со статусом `broken` в allure-results
- Сравнить с данными из терминала: 403 passed, 43 failed, 3 skipped

### 3. Проверка конфигурации pytest для Allure

- Проверить настройки `--alluredir` в pytest.ini
- Проверить опцию `--disable-warnings` - она может скрывать warnings из Allure
- Проверить, есть ли настройки для записи skipped тестов в Allure
- Проверить настройки allure-pytest плагина в pyproject.toml

### 4. Анализ обработки warnings в Allure

- Проверить, записываются ли warnings в файлы результатов
- Проверить, отображаются ли warnings в Allure отчете
- Исследовать, как allure-pytest обрабатывает pytest warnings

### 5. Проверка конфигурации Allure Service

- Проверить настройки `KEEP_HISTORY` и `KEEP_HISTORY_LATEST` в docker-compose.yml
- Проверить, не фильтрует ли Allure Service результаты по статусам
- Проверить настройки `CHECK_RESULTS_EVERY_SECONDS`
- Проверить, не группирует ли Allure тесты по testCaseId (история запусков)

### 6. Настройка для отображения всех данных

- Убрать `--disable-warnings` из pytest.ini или настроить запись warnings в Allure
- Настроить allure-pytest для записи skipped тестов
- Настроить Allure для отображения всех тестов, а не только уникальных testCaseId
- Проверить настройки категорий в allure-categories.json

## Методы исследования

1. **Анализ файлов результатов** - чтение JSON файлов для подсчета статистики
2. **PowerShell скрипт** - создание скрипта для анализа всех файлов результатов
3. **Проверка конфигурации** - анализ pytest.ini, pyproject.toml, docker-compose.yml
4. **Тестирование настроек** - проверка изменений конфигурации

## Ожидаемые результаты

- Точное количество тестов в allure-results по статусам (должно совпадать с терминалом)
- Причина расхождения между терминалом и Allure
- Настроенная конфигурация для отображения всех тестов в Allure
- Allure отчет показывает: 43 failed, 3 skipped, 374 warnings, 403 passed