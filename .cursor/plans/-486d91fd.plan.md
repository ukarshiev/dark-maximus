<!-- 486d91fd-925c-4c7d-8816-a15d0150f9fb 17184f1a-00ad-4359-a69f-1727b7cdaceb -->
# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∫–Ω–æ–ø–∫–∏ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞"

## –ü—Ä–æ–±–ª–µ–º–∞

–ö–Ω–æ–ø–∫–∞ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞" –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –±–æ—Ç–∞ –æ –∫–ª—é—á–∞—Ö.

**–ü—Ä–∏—á–∏–Ω–∞:** –í [`src/shop_bot/bot/keyboards.py`](src/shop_bot/bot/keyboards.py) (—Å—Ç—Ä–æ–∫–∏ 619-662) –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ `is_production_server()` - –≤ development —Ä–µ–∂–∏–º–µ –∫–Ω–æ–ø–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è.

## –†–µ—à–µ–Ω–∏–µ

**–£–ø—Ä–æ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É:** –∫–Ω–æ–ø–∫–∞ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞" **–í–°–ï–ì–î–ê** –≤–µ–¥—ë—Ç –Ω–∞ `https://help.dark-maximus.com/setup` –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç:

- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ `server_environment` (production/development)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ `codex_docs_domain`

–í [`src/shop_bot/bot/keyboards.py`](src/shop_bot/bot/keyboards.py) —Ñ—É–Ω–∫—Ü–∏–∏ `create_key_management_keyboard()`:

1. **–£–¥–∞–ª–∏—Ç—å –≤–µ—Å—å –±–ª–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫** (—Å—Ç—Ä–æ–∫–∏ 619-662)
2. **–ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏** —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º URL

**–í–ê–ñ–ù–û:** –£—Å–ª–æ–≤–∏–µ `is_production_server()` –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç" (—Å—Ç—Ä–æ–∫–∏ 580-617) **–ù–ï –¢–†–û–ì–ê–ï–ú**!

## –ò–∑–º–µ–Ω–µ–Ω–∏—è

### –§–∞–π–ª: [`src/shop_bot/bot/keyboards.py`](src/shop_bot/bot/keyboards.py)

**–°—Ç—Ä–æ–∫–∏ 619-662 (–±—ã–ª–æ):**

```python
# –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
# –õ–æ–≥–∏–∫–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É server_environment:
# - –í production: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback, –µ—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π
# - –í development: –∫–Ω–æ–ø–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π
codex_docs_domain = get_setting("codex_docs_domain")
setup_url = None

if codex_docs_domain:
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–æ–º–µ–Ω localhost
    domain_for_check = codex_docs_domain.replace('http://', '').replace('https://', '').split('/')[0].split(':')[0]
    if _is_local_address(domain_for_check):
        # –î–ª—è localhost –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback —Ç–æ–ª—å–∫–æ –≤ production
        if is_production_server():
            setup_url = "https://help.dark-maximus.com/setup"
            logger.debug(f"–ö–Ω–æ–ø–∫–∞ '–ù–∞—Å—Ç—Ä–æ–π–∫–∞' –¥–ª—è –∫–ª—é—á–∞ {key_id}: localhost –æ–±–Ω–∞—Ä—É–∂–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback URL={setup_url}")
        else:
            # –í development –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è localhost
            logger.debug(f"–ö–Ω–æ–ø–∫–∞ '–ù–∞—Å—Ç—Ä–æ–π–∫–∞' –¥–ª—è –∫–ª—é—á–∞ {key_id}: localhost –æ–±–Ω–∞—Ä—É–∂–µ–Ω –≤ development, –∫–Ω–æ–ø–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è")
    else:
        # –î–ª—è –Ω–µ-localhost –¥–æ–º–µ–Ω–æ–≤ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º URL
        codex_docs_domain = codex_docs_domain.strip().rstrip('/')
        # –£–±–∏—Ä–∞–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª –µ—Å–ª–∏ –µ—Å—Ç—å (–∏ http:// –∏ https://)
        if codex_docs_domain.startswith('http://'):
            codex_docs_domain = codex_docs_domain[7:]  # –£–±–∏—Ä–∞–µ–º 'http://'
        elif codex_docs_domain.startswith('https://'):
            codex_docs_domain = codex_docs_domain[8:]  # –£–±–∏—Ä–∞–µ–º 'https://'
        # –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º https:// –¥–ª—è web_app (Telegram —Ç—Ä–µ–±—É–µ—Ç HTTPS)
        setup_url = f"https://{codex_docs_domain}/setup"
        logger.debug(f"–ö–Ω–æ–ø–∫–∞ '–ù–∞—Å—Ç—Ä–æ–π–∫–∞' –¥–ª—è –∫–ª—é—á–∞ {key_id}: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–æ–º–µ–Ω –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫, setup_url={setup_url}")
else:
    # Fallback –Ω–∞ –¥–µ—Ñ–æ–ª—Ç —Ç–æ–ª—å–∫–æ –≤ production
    if is_production_server():
        setup_url = "https://help.dark-maximus.com/setup"
        logger.debug(f"–ö–Ω–æ–ø–∫–∞ '–ù–∞—Å—Ç—Ä–æ–π–∫–∞' –¥–ª—è –∫–ª—é—á–∞ {key_id}: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback URL={setup_url}")
    else:
        # –í development –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
        logger.debug(f"–ö–Ω–æ–ø–∫–∞ '–ù–∞—Å—Ç—Ä–æ–π–∫–∞' –¥–ª—è –∫–ª—é—á–∞ {key_id}: –¥–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ development, –∫–Ω–æ–ø–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è")

# –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ setup_url —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
if setup_url:
    builder.button(
        text="‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞",
        web_app=WebAppInfo(url=setup_url)
    )
```

**–°—Ç—Ä–æ–∫–∏ 619-623 (—Å—Ç–∞–ª–æ):**

```python
# –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ - –≤—Å–µ–≥–¥–∞ –≤–µ–¥—ë—Ç –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
builder.button(
    text="‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞",
    web_app=WebAppInfo(url="https://help.dark-maximus.com/setup")
)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ö–Ω–æ–ø–∫–∞ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞" –±—É–¥–µ—Ç **–≤—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è** –∏ –≤–µ—Å—Ç–∏ –Ω–∞ `https://help.dark-maximus.com/setup` –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ `server_environment` –∏ `codex_docs_domain`.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: `npx nx serve bot`
2. –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –≤ Telegram
3. "üîë –ú–æ–∏ –∫–ª—é—á–∏" ‚Üí –≤—ã–±—Ä–∞—Ç—å –∫–ª—é—á
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞"
5. –ù–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É ‚Üí –¥–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ https://help.dark-maximus.com/setup