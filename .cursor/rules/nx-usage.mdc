---
alwaysApply: true
---
## Nx Monorepo Management

- Для проекта dark-maximus всегда используй Nx команды вместо прямых Docker команд.
- Приоритет выполнения команд:  
  1) `npx nx`  
  2) `npm run`  
  3) `docker compose` (только если Nx неприменим)
- Для запуска сервисов: `npx nx serve <project-name>`
- Для сборки: `npx nx build <project-name>`
- Для остановки: `npx nx stop <project-name>`
- Для логов: `npx nx logs <project-name>`
- Для диагностики контейнеров: `npm run docker:logs`
- Для просмотра текущих проектов: `npx nx show projects`
- Для проверки статуса проектов: `npx nx show projects --with-target=serve`
- Всегда поясняй, какую команду используешь и почему, если отклоняешься от приоритета.

## Исключения для Docker

Следующие случаи являются исключениями из общего правила приоритета Nx:

1. **Тестирование** — тесты запускаются через Docker:
   - `docker compose exec monitoring pytest` — это исключение из правила Nx
   - Тестовая инфраструктура работает в отдельном контейнере `monitoring`
   - Подробности см. в `testing-rules.mdc`

2. **Низкоуровневая отладка сервиса `bot`**:
   - Сервис `bot` может управляться через Nx (`npx nx serve bot`) или Docker напрямую
   - Для отладки и низкоуровневых операций допустимо использование прямых Docker команд
   - Подробности см. в `docker-commands.mdc` (применяется только когда Nx неприменим или для отладки)

3. **Когда Nx неприменим**:
   - Если Nx не поддерживает нужную операцию, используй Docker напрямую
   - Всегда поясняй, почему используется Docker вместо Nx

## Доступные проекты
- `bot` — основной Telegram-бот  
- `web-interface` — веб-панель управления  
- `user-docs` — пользовательская документация  
- `admin-docs` — админская документация  
- `shared-utils` — общие утилиты

## Общие команды
- `npm run serve` — запустить все сервисы  
- `npm run stop` — остановить все сервисы  
- `npm run build` — собрать все проекты  
- `npm run test` — запустить все тесты  

## Структура проекта
- `apps/` — приложения (bot, web-interface, user-docs, admin-docs)  
- `libs/` — библиотеки (shared-utils, database, integrations)  
- `src/shop_bot/` — исходный код основного бота  
- `docs/` — документация проекта