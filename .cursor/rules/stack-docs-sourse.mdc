---
alwaysApply: true
---
# Цель: брать только официальные/первичные источники для нашего стека.

PRINCIPLES
- Приоритет: 1) оф. доки/спеки → 2) оф. репозитории/вики → 3) крупные провайдеры (MDN, PyPI, Git docs).
- Избегай блогов/форумов/непроверенных статей, кроме явного запроса.
- Учитывай версии: Python 3.11; aiogram 3.21.0; Flask 3.1.1; aiohttp 3.9.5; py3xui 0.4.0; pytonconnect 0.3.2; qrcode 8.2; python-dotenv 1.1.1; aiosend 2.1.2.

ALLOWLIST (domain → зачем)
- docs.docker.com, docs.docker.com/compose  → Docker/Compose
- nginx.org/en/docs                         → Nginx
- docs.python.org/3.11                      → Python 3.11, asyncio, hmac, base64, hashlib
- sqlite.org/docs                           → SQLite
- docs.aiogram.dev/en/latest                → aiogram 3.x
- flask.palletsprojects.com/en/3.1.x       → Flask 3.1
- docs.aiohttp.org/en/stable                → aiohttp 3.x
- jinja.palletsprojects.com                 → Jinja2
- tailwindcss.com/docs                      → Tailwind
- developer.mozilla.org (MDN)               → HTML5/CSS/JS reference
- www.chartjs.org/docs/latest               → Chart.js
- core.telegram.org/bots/api                → Telegram Bot API
- core.telegram.org/bots/payments-stars     → Telegram Stars
- core.telegram.org/bots/webapps            → (если нужны Web Apps)
- help.crypt.bot/crypto-pay-api             → Crypto Pay API (CryptoBot)
- api-docs.crypt.bot                        → CryptoBot exchange endpoints
- doc.heleket.com                           → Heleket API (crypto gateway) :contentReference[oaicite:0]{index=0}
- heleket.com (только /blog/ и /docs/ при необходимости) :contentReference[oaicite:1]{index=1}
- github.com/MHSanaei/3x-ui/wiki            → 3X-UI API/инструкции :contentReference[oaicite:2]{index=2}
- xtls.github.io (Xray docs, VLESS)         → VLESS/Xray спецификация
- pypi.org (конкретные пакеты)              → версии/metadata (aiosend, py3xui, qrcode, python-dotenv и т.п.) :contentReference[oaicite:3]{index=3}
- aiosend.readthedocs.io                    → aiosend (Crypto Pay API client) :contentReference[oaicite:4]{index=4}
- black.readthedocs.io, pylint.readthedocs.io, pip-tools.readthedocs.io → тулзы
- git-scm.com/docs                          → Git

SEARCH TEMPLATES
- “site:{domain} {запрос}”
- Для версий Python/Flask: “site:docs.python.org/3.11 {API}” / “site:flask.palletsprojects.com/en/3.1.x {topic}”
- Для Telegram: “site:core.telegram.org {topic}”
- Для 3X-UI: “site:github.com/MHSanaei/3x-ui/wiki {API}"
- Для VLESS/Xray: “site:xtls.github.io vless {topic}”
- Для платежей: 
  - Crypto Pay: “site:help.crypt.bot/crypto-pay-api {method}” :contentReference[oaicite:5]{index=5}
  - Heleket: “site:doc.heleket.com {endpoint}” :contentReference[oaicite:6]{index=6}
  - YooKassa: “site:yookassa.ru/developers {method}”

FALLBACK
- Если оф. раздела нет: бери README/Docs из официальных реп → (org-репы на GitHub/PyPI). Избегай копий SDK третьих лиц.

DENY (по умолчанию не использовать)
- Случайные блоги/агрегаторы, ответы из форумов/Stack Overflow, неофиц. SDK, unless explicitly asked.

NOTES
- VPN стек: 3X-UI API и протоколы Xray/VLESS — только из wiki 3X-UI и Xray docs.
- Crypto платёжки: Crypto Pay API (help.crypt.bot) + aiosend RTD; Heleket — doc.heleket.com.
- Всегда цитируй первоисточник в ответе и указывай конкретную страницу/версию.

# REF И CONTEXT7 (MCP) ПРАВИЛО
- Перед обращением к внешним сайтам сначала использовать MCP источники (Ref, затем Context7).
- Приоритет источников:
  1) Ref MCP (оптимизирован для эффективного использования токенов, точные и лаконичные данные)
  2) Context7 MCP (резервный вариант, если Ref не нашел информацию или дал неполный ответ)
  3) официальная документация (из allowlist выше)
  4) официальные репозитории / спецификации
- Если Ref не нашел информацию или дал неполный ответ → использовать Context7 как резервный источник.
- Если данные в Ref/Context7 расходятся с оф. доками → уточняй разницу явно и предлагай оба варианта с пометкой "Ref/Context7" и "официальная документация".
- Если запрос касается конкретной версии → сначала проверить в Ref, затем в Context7, есть ли локальная информация о применяемой версии и настройках.
- Не использовать контент вне allowlist, если Ref или Context7 дал ответ.
