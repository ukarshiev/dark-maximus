# KAR-29: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤ —Å Allure Framework

**–î–∞—Ç–∞:** 15.11.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ  
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 15.11.2025 05:00  
**Linear:** https://linear.app/karshiev/issue/KAR-29

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Allure Framework –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ Dark Maximus. –¶–µ–ª—å - —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ç–µ—Å—Ç–æ–≤ —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

## üìä –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

<!-- –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤ —Å Allure Framework -->

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞–Ω–∞:** 15.11.2025 01:53  
**–í–µ—Ä—Å–∏—è –ø–ª–∞–Ω–∞:** 1.1.0

### –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î):**
- `test_database_locks_fix.py` - pytest-—Ç–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ SQLite
- `test_key_numbering_fix.py` - —Ç–µ—Å—Ç –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î)
- `test_auto_renewal_functionality.py` - —Ç–µ—Å—Ç –∞–≤—Ç–æ-–ø—Ä–æ–¥–ª–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î)
- `test_notifications_fix.py` - —Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î)
- `test_timezone_utils.py` - unit-—Ç–µ—Å—Ç—ã –¥–ª—è timezone —É—Ç–∏–ª–∏—Ç (unittest, –±–µ–∑ –ë–î)
- `test_timezone_integration.py` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã timezone (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î)

**–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ, –Ω–æ –æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—É—é –ë–î - –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å):**
- `test_cabinet_links_fix.py` - —Ç–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å—Å—ã–ª–æ–∫ –∫–∞–±–∏–Ω–µ—Ç–∞ (—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–¥–µ–ª–∫–∏ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î)
- `test_deeplink_functionality.py` - —Ç–µ—Å—Ç deeplink —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–¥–µ–ª–∫–∏)
- `test_deeplink_integration.py` - —Ç–µ—Å—Ç deeplink –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–¥–µ–ª–∫–∏)
- `test_yookassa_*.py` - —Ç–µ—Å—Ç—ã YooKassa (—Ç—Ä–µ–±—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –ø–µ—Ä–µ–¥–µ–ª–∫–∏)

**–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ (–¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –≤ ad-hoc/):**
- –í—Å–µ `migrate_*.py` - –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (~10 —Ñ–∞–π–ª–æ–≤)
- –í—Å–µ `check_*.py` - –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (~15 —Ñ–∞–π–ª–æ–≤)
- `final_verification.py`, `final_deeplink_test.py` - —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
- `test_deeplink_fix.py`, `test_promo_deeplink_fix.py` - –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
- `backup_*.py`, `create_*.py`, `simulate_*.py` - —É—Ç–∏–ª–∏—Ç—ã (~10 —Ñ–∞–π–ª–æ–≤)

**–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ –≤ `tests/`: ~110+
- –ê–∫—Ç—É–∞–ª—å–Ω—ã—Ö –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤: 6-7
- –ê–∫—Ç—É–∞–ª—å–Ω—ã—Ö, –Ω–æ —Ç—Ä–µ–±—É—é—â–∏—Ö –ø–µ—Ä–µ–¥–µ–ª–∫–∏: 5-6
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö/—É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö: –æ—Å—Ç–∞–ª—å–Ω—ã–µ

### –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

- –ù–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
- –ú–Ω–æ–≥–∏–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–∞–ª—å–Ω—É—é –ë–î `users.db` –≤–º–µ—Å—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ù–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –°–º–µ—à–∞–Ω—ã –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ conftest.py              # –û–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã (–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ë–î, –º–æ–∫–∏)
‚îú‚îÄ‚îÄ pytest.ini               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
‚îú‚îÄ‚îÄ unit/                    # Unit-—Ç–µ—Å—Ç—ã (–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø–∏—Ä–∞–º–∏–¥—ã - 70%)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ test_database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_locks.py              # ‚Üê test_database_locks_fix.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_key_numbering.py      # ‚Üê test_key_numbering_fix.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_auto_renewal.py       # ‚Üê test_auto_renewal_functionality.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_notifications.py      # ‚Üê test_notifications_fix.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_cabinet_links.py      # ‚Üê test_cabinet_links_fix.py (–ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_user_operations.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_promo_code_operations.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_transaction_operations.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ test_bot/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_handlers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_promo_code_logic.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ test_utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_timezone_utils.py     # ‚Üê test_timezone_utils.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_deeplink.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_validators.py
‚îÇ   ‚îî‚îÄ‚îÄ test_security/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ test_validators.py
‚îú‚îÄ‚îÄ integration/             # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (—Å–µ—Ä–µ–¥–∏–Ω–∞ - 20%)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ test_timezone_integration.py   # ‚Üê test_timezone_integration.py
‚îÇ   ‚îú‚îÄ‚îÄ test_deeplink_flow.py          # ‚Üê test_deeplink_functionality.py (–ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å)
‚îÇ   ‚îú‚îÄ‚îÄ test_deeplink_integration.py   # ‚Üê test_deeplink_integration.py (–ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å)
‚îÇ   ‚îú‚îÄ‚îÄ test_promo_code_flow.py
‚îÇ   ‚îú‚îÄ‚îÄ test_user_registration_flow.py
‚îÇ   ‚îî‚îÄ‚îÄ test_payment_flow.py
‚îú‚îÄ‚îÄ e2e/                     # End-to-End —Ç–µ—Å—Ç—ã (–≤–µ—Ä—à–∏–Ω–∞ - 10%)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ test_full_bot_flows.py
‚îî‚îÄ‚îÄ ad-hoc/                  # –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ migrations/          # ‚Üê migrate_*.py
    ‚îú‚îÄ‚îÄ checks/              # ‚Üê check_*.py
    ‚îú‚îÄ‚îÄ backups/             # ‚Üê backup_*.py
    ‚îú‚îÄ‚îÄ utils/               # ‚Üê create_*, simulate_*, show_*, get_*.py
    ‚îú‚îÄ‚îÄ tests/               # ‚Üê –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ test_*.py
    ‚îú‚îÄ‚îÄ final/               # ‚Üê final_*.py
    ‚îî‚îÄ‚îÄ reports/             # ‚Üê *.md —Ñ–∞–π–ª—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
```

### –ü–∏—Ä–∞–º–∏–¥–∞ —Ç–µ—Å—Ç–æ–≤

```
        /\
       /  \  E2E (10%) - –ü–æ–ª–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
      /____\
     /      \  Integration (20%) - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    /________\
   /          \  Unit (70%) - –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–æ–¥—É–ª–∏
  /____________\
```

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:**
- **Unit-—Ç–µ—Å—Ç—ã (70%)** - –±—ã—Å—Ç—Ä—ã–µ, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É
- **Integration-—Ç–µ—Å—Ç—ã (20%)** - –ø—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **E2E-—Ç–µ—Å—Ç—ã (10%)** - –ø–æ–ª–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### –≠—Ç–∞–ø 1: –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤ (–ë–µ–∑–æ–ø–∞—Å–Ω–æ - –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–¥–µ–ª–∫–∞)

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤, –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –∏ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î

##### –≠—Ç–∞–ø 1.1: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤: `tests/unit/`, `tests/integration/`, `tests/e2e/`, `tests/ad-hoc/` —Å –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞–º–∏
- –°–æ–∑–¥–∞—Ç—å `__init__.py` —Ñ–∞–π–ª—ã –≤–æ –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö
- **–í—Ä–µ–º—è:** ~10 –º–∏–Ω—É—Ç

##### –≠—Ç–∞–ø 1.2: –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ ad-hoc
- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏, –ø—Ä–æ–≤–µ—Ä–∫–∏, —É—Ç–∏–ª–∏—Ç—ã –∏ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –≤ `tests/ad-hoc/`
- –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ `tests/ad-hoc/` –ø–æ —Ç–∏–ø–∞–º
- **–í—Ä–µ–º—è:** ~20-30 –º–∏–Ω—É—Ç

##### –≠—Ç–∞–ø 1.3: –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏
- –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å –æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î (`test_cabinet_links_fix.py`, `test_deeplink_*.py`)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã YooKassa
- –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤–æ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ—â–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö
- **–í—Ä–µ–º—è:** ~2-3 —á–∞—Å–∞

##### –≠—Ç–∞–ø 1.4: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ—Å—Ç–æ–≤
- –°–æ–∑–¥–∞—Ç—å `tests/conftest.py` —Å –±–∞–∑–æ–≤—ã–º–∏ —Ñ–∏–∫—Å—Ç—É—Ä–∞–º–∏ (temp_db, –º–æ–∫–∏)
- –°–æ–∑–¥–∞—Ç—å `pytest.ini` –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ pytest
- –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤ `.cursor/rules/rights-rules.mdc`
- **–í—Ä–µ–º—è:** ~30-40 –º–∏–Ω—É—Ç

**–û–±—â–µ–µ –≤—Ä–µ–º—è –≠—Ç–∞–ø–∞ 1:** ~3-4 —á–∞—Å–∞

---

#### –≠—Ç–∞–ø 2: –ë–∞–∑–æ–≤—ã–µ unit-—Ç–µ—Å—Ç—ã
- –°–æ–∑–¥–∞—Ç—å `tests/unit/test_utils/test_deeplink.py`
- –°–æ–∑–¥–∞—Ç—å `tests/unit/test_security/test_validators.py`
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ `@pytest.mark.unit`
- **–í—Ä–µ–º—è:** ~2-3 —á–∞—Å–∞

---

#### –≠—Ç–∞–ø 3: –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π: `test_user_operations.py`, `test_promo_code_operations.py`, `test_transaction_operations.py`
- –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ë–î
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ `@pytest.mark.unit` –∏ `@pytest.mark.database`
- **–í—Ä–µ–º—è:** ~4-6 —á–∞—Å–æ–≤

---

#### –≠—Ç–∞–ø 4: –¢–µ—Å—Ç—ã –±–æ—Ç–∞ —Å –º–æ–∫–∞–º–∏
- –°–æ–∑–¥–∞—Ç—å –º–æ–∫–∏ –≤ `conftest.py` (mock_bot, mock_xui_api, mock_yookassa)
- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±–æ—Ç–∞, –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ `@pytest.mark.unit` –∏ `@pytest.mark.bot`
- **–í—Ä–µ–º—è:** ~4-6 —á–∞—Å–æ–≤

---

#### –≠—Ç–∞–ø 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–æ–ª–Ω—ã—Ö flow: `test_promo_code_flow.py`, `test_user_registration_flow.py`
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ë–î
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ `@pytest.mark.integration`
- **–í—Ä–µ–º—è:** ~3-4 —á–∞—Å–∞

---

#### –≠—Ç–∞–ø 6: E2E —Ç–µ—Å—Ç—ã (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –°–æ–∑–¥–∞—Ç—å `tests/e2e/test_full_bot_flows.py`
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è E2E
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ `@pytest.mark.e2e`
- **–í—Ä–µ–º—è:** ~4-6 —á–∞—Å–æ–≤

---

#### –≠—Ç–∞–ø 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Allure Framework
- –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `pyproject.toml`
- –°–æ–∑–¥–∞—Ç—å `Dockerfile.tests` –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã –≤ `docker-compose.yml` (tests, allure-service)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `pytest.ini` –¥–ª—è Allure
- –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ `tests/run_tests.sh`
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è `allure.dark-maximus.com`
- **–í—Ä–µ–º—è:** ~2-3 —á–∞—Å–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ Allure Service –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- –î–æ—Å—Ç—É–ø –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ `allure.dark-maximus.com`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤

---

#### –≠—Ç–∞–ø 8: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç `tests/run_tests_scheduled.sh` –¥–ª—è cron
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏–ª–∏ —Å–∏—Å—Ç–µ–º–µ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub Actions
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Ç–µ—Å—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞)
- **–í—Ä–µ–º—è:** ~2-3 —á–∞—Å–∞

---

## üîí –ì–∞—Ä–∞–Ω—Ç–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –¢–µ—Å—Ç—ã –Ω–µ –ø–æ–≤—Ä–µ–¥—è—Ç –ø—Ä–æ–µ–∫—Ç

1. **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –≤—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ë–î
2. **–ú–æ–∫–∏ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤** - Telegram, XUI, –ø–ª–∞—Ç–µ–∂–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
3. **–¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤** - –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
4. **–û—Ç–¥–µ–ª—å–Ω—ã–µ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** - —Ç–µ—Å—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
5. **–ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ** - –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

---

## üìù To-dos

- [x] –≠—Ç–∞–ø 1.1: –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (unit/, integration/, e2e/, ad-hoc/ —Å –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞–º–∏) –∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ __init__.py —Ñ–∞–π–ª—ã
- [x] –≠—Ç–∞–ø 1.2: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (migrate_*, check_*, create_*, simulate_*, test_deeplink_fix.py –∏ —Ç.–¥.) –≤ tests/ad-hoc/ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –ø–æ —Ç–∏–ø–∞–º
- [x] –≠—Ç–∞–ø 1.3: –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ (test_database_locks_fix.py ‚Üí unit/test_database/, test_timezone_utils.py ‚Üí unit/test_utils/ –∏ —Ç.–¥.) –∏ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –æ–ø–∞—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã (test_cabinet_links_fix.py, test_deeplink_*.py) –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î
- [x] –≠—Ç–∞–ø 1.4: –°–æ–∑–¥–∞—Ç—å conftest.py —Å —Ñ–∏–∫—Å—Ç—É—Ä–æ–π temp_db –∏ –±–∞–∑–æ–≤—ã–º–∏ –º–æ–∫–∞–º–∏, —Å–æ–∑–¥–∞—Ç—å pytest.ini —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏, –æ–±–Ω–æ–≤–∏—Ç—å rights-rules.mdc
- [x] –≠—Ç–∞–ø 2: –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ unit-—Ç–µ—Å—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏—Ç (deeplink, validators) —Å —Ç–µ–≥–∞–º–∏ @pytest.mark.unit - –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ë–î –∏ –±–æ—Ç–∞
- [x] –≠—Ç–∞–ø 3: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ë–î (user_operations, promo_code_operations, transaction_operations) —Å —Ç–µ–≥–∞–º–∏ @pytest.mark.unit –∏ @pytest.mark.database
- [x] –≠—Ç–∞–ø 4: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –±–æ—Ç–∞ —Å –º–æ–∫–∞–º–∏ (handlers, promo_code_logic, keyboard_generation) —Å —Ç–µ–≥–∞–º–∏ @pytest.mark.unit –∏ @pytest.mark.bot
- [x] –≠—Ç–∞–ø 5: –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (promo_code_flow, user_registration_flow) —Å —Ç–µ–≥–∞–º–∏ @pytest.mark.integration
- [ ] –≠—Ç–∞–ø 6: –°–æ–∑–¥–∞—Ç—å E2E —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å —Ç–µ–≥–∞–º–∏ @pytest.mark.e2e (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [x] –≠—Ç–∞–ø 7: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Allure Framework (Dockerfile.tests, allure-service –≤ docker-compose.yml, pytest.ini —Å allure, —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤, Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [ ] –≠—Ç–∞–ø 8: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∏ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** `.cursor/plans/dark-maximus-0223f44d-eb265aa0.plan.md`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:** `docs/guides/development/testing.md` (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞)

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 15.11.2025 05:00  
**–í–µ—Ä—Å–∏—è:** 4.18.1

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã

#### ‚úÖ –≠—Ç–∞–ø 1: –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤
- **1.1** –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ (`tests/unit/`, `tests/integration/`, `tests/e2e/`, `tests/ad-hoc/` —Å –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞–º–∏)
- **1.2** –í—Å–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ `tests/ad-hoc/` —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–µ–π –ø–æ —Ç–∏–ø–∞–º
- **1.3** –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –∏ –ø–µ—Ä–µ–¥–µ–ª–∞–Ω—ã –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ë–î
- **1.4** –°–æ–∑–¥–∞–Ω `conftest.py` —Å —Ñ–∏–∫—Å—Ç—É—Ä–æ–π `temp_db` –∏ –±–∞–∑–æ–≤—ã–º–∏ –º–æ–∫–∞–º–∏, –Ω–∞—Å—Ç—Ä–æ–µ–Ω `pytest.ini`

#### ‚úÖ –≠—Ç–∞–ø 2: –ë–∞–∑–æ–≤—ã–µ unit-—Ç–µ—Å—Ç—ã
- –°–æ–∑–¥–∞–Ω `tests/unit/test_utils/test_deeplink.py` - —Ç–µ—Å—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏—Ç deeplink
- –°–æ–∑–¥–∞–Ω `tests/unit/test_security/test_validators.py` - —Ç–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤

#### ‚úÖ –≠—Ç–∞–ø 3: –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–Ω `tests/unit/test_database/test_user_operations.py` - —Ç–µ—Å—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –°–æ–∑–¥–∞–Ω `tests/unit/test_database/test_promo_code_operations.py` - —Ç–µ—Å—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏
- –°–æ–∑–¥–∞–Ω `tests/unit/test_database/test_transaction_operations.py` - —Ç–µ—Å—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏

#### ‚úÖ –≠—Ç–∞–ø 4: –¢–µ—Å—Ç—ã –±–æ—Ç–∞ —Å –º–æ–∫–∞–º–∏
- –°–æ–∑–¥–∞–Ω `tests/unit/test_bot/test_handlers.py` - —Ç–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±–æ—Ç–∞
- –°–æ–∑–¥–∞–Ω `tests/unit/test_bot/test_promo_code_logic.py` - —Ç–µ—Å—Ç—ã –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- –°–æ–∑–¥–∞–Ω `tests/unit/test_bot/test_keyboard_generation.py` - —Ç–µ—Å—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä

#### ‚úÖ –≠—Ç–∞–ø 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –°–æ–∑–¥–∞–Ω `tests/integration/test_deeplink_flow.py` - —Ç–µ—Å—Ç—ã flow deeplink
- –°–æ–∑–¥–∞–Ω `tests/integration/test_deeplink_integration.py` - —Ç–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ deeplink
- –°–æ–∑–¥–∞–Ω `tests/integration/test_timezone_integration.py` - —Ç–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ timezone

#### ‚úÖ –≠—Ç–∞–ø 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Allure Framework
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `pyproject.toml` (pytest, allure-pytest, faker –∏ –¥—Ä.)
- –°–æ–∑–¥–∞–Ω `Dockerfile.tests` –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤ —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π Allure CLI (–≤–µ—Ä—Å–∏—è 2.24.1)
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã `monitoring` –∏ `allure-service` –≤ `docker-compose.yml`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω `pytest.ini` –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Allure Framework
- –°–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤: `tests/run_tests.sh` –∏ `tests/run_tests.ps1`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx –¥–ª—è `allure.dark-maximus.com` (HTTP –∏ HTTPS)
- –û–±–Ω–æ–≤–ª–µ–Ω —à–∞–±–ª–æ–Ω `deploy/nginx/dark-maximus.conf.tpl` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–¥–¥–æ–º–µ–Ω–∞
- –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `install-autotest.sh` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤

#### üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Ä—è–¥–æ–∫ COPY –æ–ø–µ—Ä–∞—Ü–∏–π –≤ `Dockerfile.tests` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–∞
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω —Å–µ—Ä–≤–∏—Å `tests` ‚Üí `monitoring` ‚Üí `autotest` –¥–ª—è –ª—É—á—à–µ–π —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:**
- ‚úÖ **Passed:** 103 —Ç–µ—Å—Ç–∞
- ‚ùå **Failed:** 15 —Ç–µ—Å—Ç–æ–≤
- ‚ö†Ô∏è **Broken:** 14 —Ç–µ—Å—Ç–æ–≤
- üì¶ **Total:** 132 —Ç–µ—Å—Ç–∞
- üìÅ **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:** 308 JSON —Ñ–∞–π–ª–æ–≤ –≤ `allure-results/`

### –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

**–õ–æ–∫–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø:**
- Swagger UI (API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è): `http://localhost:50005`
- Allure Reports: `http://localhost:50005/allure-docker-service/projects/default/reports/latest/index.html`

**–í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL):**
- `https://allure.dark-maximus.com/allure-docker-service/projects/default/reports/latest/index.html`

### –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `Dockerfile.tests` - Dockerfile –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
- `install-autotest.sh` - —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
- `tests/conftest.py` - –æ–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã pytest
- `pytest.ini` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest —Å Allure
- `tests/run_tests.sh` - —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ (bash)
- `tests/run_tests.ps1` - —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ (PowerShell)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `docker-compose.yml` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã `autotest` –∏ `allure-service`
- `pyproject.toml` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–≤–µ—Ä—Å–∏—è 4.18.1)
- `nginx/nginx.conf` –∏ `nginx/nginx-ssl.conf` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è `allure.dark-maximus.com`
- `deploy/nginx/dark-maximus.conf.tpl` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–¥–¥–æ–º–µ–Ω–∞
- `.cursor/rules/rights-rules.mdc` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ—Å—Ç–∞–º–∏

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
docker compose exec autotest pytest

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ unit-—Ç–µ—Å—Ç—ã
docker compose exec autotest pytest tests/unit/ -m unit

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
docker compose exec autotest pytest tests/integration/ -m integration

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤
sudo ./install-autotest.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ Allure Service
docker compose logs -f allure-service
```

### –ì–∞—Ä–∞–Ω—Ç–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ë–î (–Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç `users.db`)  
‚úÖ –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã (Telegram, XUI, –ø–ª–∞—Ç–µ–∂–∏) –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–æ–∫–∏—Ä–æ–≤–∞–Ω—ã  
‚úÖ –¢–µ—Å—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö  
‚úÖ –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è - —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- **–≠—Ç–∞–ø 6:** –°–æ–∑–¥–∞—Ç—å E2E —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–≠—Ç–∞–ø 8:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∏ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 15.11.2025 05:00

