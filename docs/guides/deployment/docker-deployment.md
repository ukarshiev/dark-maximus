# ะะตะทัะผะต: Docker-ะบะพะฝัะตะนะฝะตัะธะทะฐัะธั ะฒัะตั ัะตัะฒะธัะพะฒ

> ะะฐัะฐ: 10.11.2025  
> ะะตััะธั: 2.66.13

## ๐ฏ ะงัะพ ะฑัะปะพ ัะดะตะปะฐะฝะพ

### 1. ะกะพะทะดะฐะฝั Dockerfile'ั ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ

#### Dockerfile.docs (ะะพะปัะทะพะฒะฐัะตะปััะบะฐั ะดะพะบัะผะตะฝัะฐัะธั)
- **Multi-stage build** ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ Alpine Linux
- **Nginx unprivileged** ะดะปั ะฑะตะทะพะฟะฐัะฝะพััะธ (ะฟะพัั 8080)
- **Healthcheck** endpoint ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ
- **Gzip ัะถะฐัะธะต** ะธ ะบััะธัะพะฒะฐะฝะธะต ััะฐัะธะบะธ
- **ะะต-root ะฟะพะปัะทะพะฒะฐัะตะปั** (nginx)

#### Dockerfile.codex-docs (ะะดะผะธะฝัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั)
- **Multi-stage build** ะดะปั ะพะฟัะธะผะธะทะฐัะธะธ
- ะะฐะทะพะฒัะน ะพะฑัะฐะท: `ghcr.io/codex-team/codex.docs:v2.0.0-rc.8`
- **WebSocket ะฟะพะดะดะตัะถะบะฐ** ะดะปั Codex.docs
- **Healthcheck** ะดะปั ะฟัะพะฒะตัะบะธ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ
- **Volumes** ะดะปั ะดะฐะฝะฝัั ะธ ะทะฐะณััะทะพะบ

### 2. ะะฑะฝะพะฒะปะตะฝ docker-compose.yml

```yaml
services:
  bot:
    build: .
    ports: ['50000:50000']
    
  docs:
    build:
      dockerfile: Dockerfile.docs
    ports: ['50001:80']
    healthcheck: โ
    
  codex-docs:
    build:
      dockerfile: Dockerfile.codex-docs
    ports: ['50002:50002']
    healthcheck: โ
```

### 3. ะะฑะฝะพะฒะปะตะฝ ัะบัะธะฟั ัััะฐะฝะพะฒะบะธ (install.sh)

#### ะะพะฑะฐะฒะปะตะฝะฐ ะฝะฐัััะพะนะบะฐ Nginx ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ:

```nginx
# ะัะฝะพะฒะฝะพะน ะฑะพั
server {
    server_name your-domain.com;
    location / {
        proxy_pass http://127.0.0.1:50000;
    }
}

# ะะพะปัะทะพะฒะฐัะตะปััะบะฐั ะดะพะบัะผะตะฝัะฐัะธั
server {
    server_name docs.your-domain.com;
    location / {
        proxy_pass http://127.0.0.1:50001;
    }
}

# ะะดะผะธะฝัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั
server {
    server_name admin-docs.your-domain.com;
    location / {
        proxy_pass http://127.0.0.1:50002;
        # WebSocket ะฟะพะดะดะตัะถะบะฐ
    }
}
```

### 4. ะกะพะทะดะฐะฝ .dockerignore

ะัะบะปััะตะฝั ะฝะตะฝัะถะฝัะต ัะฐะนะปั ะธะท ะบะพะฝัะตะบััะฐ ัะฑะพัะบะธ:
- Git ัะฐะนะปั
- Python ะบัั
- Node modules
- IDE ะฝะฐัััะพะนะบะธ
- ะะพะณะธ ะธ ะฒัะตะผะตะฝะฝัะต ัะฐะนะปั

### 5. ะกะพะทะดะฐะฝะฐ ะดะพะบัะผะตะฝัะฐัะธั

- **docs/architecture/docker-architecture.md** - ะฟะพะปะฝะพะต ะพะฟะธัะฐะฝะธะต Docker ะฐััะธัะตะบัััั
- **docs/guides/deployment/docker-deployment.md** - ััะพ ัะตะทัะผะต

## ๐ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    Nginx Reverse Proxy                   โ
โ  (SSL: Let's Encrypt, Port: 443/8443)                   โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโ
                   โ                  โ
        โโโโโโโโโโโโผโโโโโโโโโโโ       โ
        โ  ะัะฝะพะฒะฝะพะน ะฑะพั       โ       โ
        โ  :50000             โ       โ
        โ  (Python + Flask)   โ       โ
        โโโโโโโโโโโโโโโโโโโโโโโ       โ
                                      โ
                        โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                        โ  ะะพะปัะทะพะฒะฐัะตะปััะบะฐั ะดะพะบ-ั   โ
                        โ  :50001 (ะฒะฝััั. 8080)      โ
                        โ  (Nginx + ััะฐัะธะบะฐ)        โ
                        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                      โ
                        โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                        โ  ะะดะผะธะฝัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั   โ
                        โ  :50002                    โ
                        โ  (Codex.docs)             โ
                        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะฐะบ ัะฐะทะฒะตัะฝััั ะฝะฐ ะฑะพะตะฒะพะผ ัะตัะฒะตัะต

### ะจะฐะณ 1: ะะพะดะบะปััะธัะตัั ะบ ัะตัะฒะตัั

```bash
ssh user@your-server-ip
```

### ะจะฐะณ 2: ะะฐะฟัััะธัะต ัััะฐะฝะพะฒะบั

```bash
curl -sSL https://raw.githubusercontent.com/ukarshiev/dark-maximus/main/install.sh | sudo bash
```

### ะจะฐะณ 3: ะกะปะตะดัะนัะต ะธะฝััััะบัะธัะผ

ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะธ:
1. โ ะฃััะฐะฝะพะฒะธั Docker, Nginx, Certbot
2. โ ะะปะพะฝะธััะตั ัะตะฟะพะทะธัะพัะธะน
3. โ ะะพะปััะธั SSL-ัะตััะธัะธะบะฐั
4. โ ะะฐัััะพะธั Nginx ะดะปั ะฒัะตั ััะตั ัะตัะฒะธัะพะฒ
5. โ ะกะพะฑะตัะตั ะธ ะทะฐะฟัััะธั Docker-ะบะพะฝัะตะนะฝะตัั
6. โ ะะฐะทะฒะตัะฝะตั ะดะพะบัะผะตะฝัะฐัะธั

### ะจะฐะณ 4: ะะฐัััะพะนัะต DNS

ะะพะฑะฐะฒััะต A-ะทะฐะฟะธัะธ ะดะปั ะฟะพะดะดะพะผะตะฝะพะฒ:
```
your-domain.com          โ IP ัะตัะฒะตัะฐ
docs.your-domain.com     โ IP ัะตัะฒะตัะฐ
admin-docs.your-domain.com โ IP ัะตัะฒะตัะฐ
```

## ๐ ะะพัััะฟะฝัะต ะฐะดัะตัะฐ

ะะพัะปะต ัััะฐะฝะพะฒะบะธ ะฑัะดัั ะดะพัััะฟะฝั:

1. **ะัะฝะพะฒะฝะพะน ะฑะพั ะธ ะฐะดะผะธะฝ-ะฟะฐะฝะตะปั**
   - `https://your-domain.com:443/login`
   - ะะพะณะธะฝ: `admin`
   - ะะฐัะพะปั: `admin`

2. **ะะพะปัะทะพะฒะฐัะตะปััะบะฐั ะดะพะบัะผะตะฝัะฐัะธั**
   - `https://docs.your-domain.com:443`

3. **ะะดะผะธะฝัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั (Codex.docs)**
   - `https://admin-docs.your-domain.com:443`

## ๐ง ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะตะนะฝะตัะฐะผะธ

### ะัะพัะผะพัั ััะฐัััะฐ

```bash
docker compose ps
```

### ะัะพัะผะพัั ะปะพะณะพะฒ

```bash
# ะัะต ะปะพะณะธ
docker compose logs -f

# ะะพะฝะบัะตัะฝัะน ัะตัะฒะธั
docker compose logs -f bot
docker compose logs -f docs
docker compose logs -f codex-docs
```

### ะะตัะตะทะฐะฟััะบ

```bash
# ะัะต ัะตัะฒะธัั
docker compose restart

# ะะพะฝะบัะตัะฝัะน ัะตัะฒะธั
docker compose restart bot
```

### ะะฑะฝะพะฒะปะตะฝะธะต

```bash
# ะะฑะฝะพะฒะปะตะฝะธะต ะบะพะดะฐ
git pull

# ะะตัะตัะฑะพัะบะฐ ะธ ะฟะตัะตะทะฐะฟััะบ
docker compose down
docker compose up -d --build
```

## ๐ ะัะตะธะผััะตััะฒะฐ ะฝะพะฒะพะน ะฐััะธัะตะบัััั

### 1. ะะตะทะพะฟะฐัะฝะพััั
- โ ะะต-root ะฟะพะปัะทะพะฒะฐัะตะปะธ ะฒะพ ะฒัะตั ะบะพะฝัะตะนะฝะตัะฐั
- โ ะะทะพะปะธัะพะฒะฐะฝะฝัะต ัะตัะฒะธัั
- โ ะะธะฝะธะผะฐะปัะฝัะต ะพะฑัะฐะทั (ะผะตะฝััะต attack surface)
- โ Healthchecks ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ

### 2. ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั
- โ Multi-stage builds (ะผะตะฝััะต ัะฐะทะผะตั ะพะฑัะฐะทะพะฒ)
- โ Layer caching (ะฑััััะฐั ัะฑะพัะบะฐ)
- โ ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฝัะต Nginx ะบะพะฝัะธะณััะฐัะธะธ
- โ Gzip ัะถะฐัะธะต

### 3. ะะฐัััะฐะฑะธััะตะผะพััั
- โ ะะตะณะบะพ ะดะพะฑะฐะฒะธัั ะฝะพะฒัะต ัะตัะฒะธัั
- โ ะะตะทะฐะฒะธัะธะผะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต
- โ ะะพัะธะทะพะฝัะฐะปัะฝะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต ัะตัะตะท Docker Swarm/Kubernetes

### 4. ะฃะฟัะฐะฒะปัะตะผะพััั
- โ ะะดะธะฝัะน docker-compose.yml
- โ ะัะพััะพะต ะพะฑะฝะพะฒะปะตะฝะธะต
- โ ะะตะณะบะพะต ัะตะทะตัะฒะฝะพะต ะบะพะฟะธัะพะฒะฐะฝะธะต
- โ ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต

## ๐ ะะพะฝะธัะพัะธะฝะณ

### Healthchecks

ะัะต ัะตัะฒะธัั ะธะผะตัั ะฒัััะพะตะฝะฝัะต healthchecks:

```bash
# ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั
docker compose ps

# ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั
docker inspect dark-maximus-bot | grep Health -A 10
```

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ

```bash
# ะะพะฝะธัะพัะธะฝะณ ัะตััััะพะฒ
docker stats
```

## ๐๏ธ Troubleshooting

### ะะพะฝัะตะนะฝะตั ะฝะต ะทะฐะฟััะบะฐะตััั

```bash
# ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ
docker compose logs bot

# ะัะพะฒะตัะบะฐ ะบะพะฝัะธะณััะฐัะธะธ
docker compose config
```

### ะัะพะฑะปะตะผั ั ะฟะพััะฐะผะธ

```bash
# ะัะพะฒะตัะบะฐ ะทะฐะฝัััั ะฟะพััะพะฒ
netstat -tulpn | grep -E '50000|50001|50002'
```

### ะะตัะตัะฑะพัะบะฐ ะฑะตะท ะบััะฐ

```bash
docker compose build --no-cache
docker compose up -d
```

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตััััั

- [Docker Architecture Documentation](../../architecture/docker-architecture.md)
- [Installation Guide](../README.md)
- [Production Checklist](production-checklist.md)
- [Security Checklist](../../security/security-checklist.md)

## โ ะงะตะบะปะธัั ัะฐะทะฒะตัััะฒะฐะฝะธั

- [ ] ะกะตัะฒะตั ั Ubuntu/Debian
- [ ] ะะพะผะตะฝ ั ะฝะฐัััะพะตะฝะฝัะผะธ DNS A-ะทะฐะฟะธััะผะธ
- [ ] ะัะบัััั ะฟะพััั 80, 443, 50000
- [ ] ะะฐะฟััะตะฝ ัะบัะธะฟั ัััะฐะฝะพะฒะบะธ
- [ ] ะัะพะฒะตัะตะฝั ะฒัะต ััะธ ัะตัะฒะธัะฐ
- [ ] ะกะผะตะฝะตะฝั ะฟะฐัะพะปะธ ะฟะพ ัะผะพะปัะฐะฝะธั
- [ ] ะะฐัััะพะตะฝั ะฟะปะฐัะตะถะฝัะต ัะธััะตะผั
- [ ] ะะฐัััะพะตะฝั webhooks

---

**ะะพัะพะฒะพ ะบ production!** ๐

*ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต: 14.10.2025*

