> Обновлено: 24.09.2025

# API: Повторная отправка уведомления

## Эндпоинт
- Метод: `POST`
- Путь: `/resend-notification/{notification_id}`
- Аутентификация: админская сессия (`session` cookie)

## Параметры пути
- `notification_id` (int, обязательно): ID существующего уведомления в таблице `notifications`.

## Ответы

### 200 OK
```json
{ "message": "Уведомление отправлено повторно" }
```

### 404 Not Found
```json
{ "message": "Уведомление не найдено" }
```

### 400 Bad Request
```json
{ "message": "Невозможно отправить: у пользователя нет активных ключей" }
```

### 503 Service Unavailable
```json
{ "message": "Бот не запущен. Запустите бота на панели и повторите." }
```

### 500 Internal Server Error
```json
{ "message": "Внутренняя ошибка сервера" }
```

## Поведение
- Эндпоинт извлекает данные исходного уведомления, определяет ключ и дату истечения; при необходимости выбирает ближайший активный ключ пользователя.
- Запускает повторную отправку через Telegram-бота (асинхронно).
- В таблицу `notifications` будет добавлена новая запись со статусом `sent` (повтор фиксируется по факту отправки).

## Пример CURL
```bash
curl -X POST "http://localhost:1488/resend-notification/123" \
  -b "session=<admin-session-cookie>"
```


