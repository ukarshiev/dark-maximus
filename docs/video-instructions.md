# Видеоинструкции Dark Maximus

> Обновлено: 29.09.2025

## Обзор

Dark Maximus поддерживает автоматическую выдачу видеоинструкций пользователям для настройки VPN на различных платформах. Это значительно упрощает процесс подключения для пользователей.

## Поддерживаемые платформы

- **Android** - `android_video.mp4`
- **iOS** - `ios_video.mp4`
- **Windows** - `windows_video.mp4`
- **macOS** - `macos_video.mp4`
- **Linux** - `linux_video.mp4`

## Структура файлов

```
video_instructions/
├── README.md
├── ИНСТРУКЦИЯ_ПРИМЕНЕНИЯ.md
├── android_video.mp4
├── ios_video.mp4
├── windows_video.mp4
├── macos_video.mp4
└── linux_video.mp4
```

## Настройка

### 1. Включение видеоинструкций

В файле `src/shop_bot/config.py`:

```python
# Поддержка видеоинструкций
VIDEO_INSTRUCTIONS_ENABLED = True
VIDEO_INSTRUCTIONS_DIR = "video_instructions"
```

### 2. Размещение видеофайлов

Поместите видеофайлы в папку `video_instructions/` в корне проекта:

- `android_video.mp4` - инструкция для Android
- `ios_video.mp4` - инструкция для iOS
- `windows_video.mp4` - инструкция для Windows
- `macos_video.mp4` - инструкция для macOS
- `linux_video.mp4` - инструкция для Linux

## Использование в боте

### Автоматическая выдача

Когда пользователь выбирает "Инструкция как пользоваться" в боте, система:

1. Показывает меню выбора операционной системы
2. Пользователь выбирает свою ОС
3. Бот проверяет наличие видеоинструкции для выбранной платформы
4. Если видео есть - отправляет его пользователю
5. Если видео нет - отправляет текстовую инструкцию

### Код обработки

```python
def get_video_instruction_path(platform: str) -> str:
    """Возвращает путь к видеоинструкции для платформы"""
    video_mapping = {
        'android': 'android_video.mp4',
        'ios': 'ios_video.mp4', 
        'windows': 'windows_video.mp4',
        'macos': 'macos_video.mp4',
        'linux': 'linux_video.mp4',
    }
    return f"{VIDEO_INSTRUCTIONS_DIR}/{video_mapping.get(platform, 'android_video.mp4')}"

def has_video_instruction(platform: str) -> bool:
    """Проверяет, есть ли видеоинструкция для платформы"""
    if not VIDEO_INSTRUCTIONS_ENABLED:
        return False
    
    from pathlib import Path
    video_path = Path(get_video_instruction_path(platform))
    return video_path.exists()
```

## Рекомендации по созданию видео

### Формат и качество
- **Формат**: MP4
- **Кодек**: H.264
- **Разрешение**: 1920x1080 (Full HD) или 1280x720 (HD)
- **Частота кадров**: 30 FPS
- **Битрейт**: 2-5 Mbps

### Содержание видео
1. **Вступление** (5-10 сек) - приветствие и краткое описание
2. **Скачивание приложения** (30-60 сек) - где найти и как скачать VPN приложение
3. **Настройка подключения** (60-120 сек) - пошаговая настройка с ключом
4. **Проверка работы** (15-30 сек) - как проверить, что VPN работает
5. **Заключение** (5-10 сек) - подведение итогов

### Длительность
- **Общая длительность**: 2-4 минуты
- **Максимальный размер файла**: 50-100 MB
- **Оптимальный размер**: 20-50 MB

## Отключение видеоинструкций

Если нужно отключить видеоинструкции:

```python
# В src/shop_bot/config.py
VIDEO_INSTRUCTIONS_ENABLED = False
```

В этом случае бот будет отправлять только текстовые инструкции.

## Обновление видео

Для обновления видеоинструкций:

1. Замените соответствующий файл в папке `video_instructions/`
2. Убедитесь, что имя файла соответствует ожидаемому
3. Перезапустите бота: `docker compose restart bot`

## Troubleshooting

### Видео не отправляется
1. Проверьте, что файл существует в правильной папке
2. Убедитесь, что `VIDEO_INSTRUCTIONS_ENABLED = True`
3. Проверьте права доступа к файлу
4. Посмотрите логи бота на предмет ошибок

### Большой размер файла
1. Сожмите видео с помощью ffmpeg:
   ```bash
   ffmpeg -i input.mp4 -c:v libx264 -crf 28 -c:a aac -b:a 128k output.mp4
   ```
2. Уменьшите разрешение или битрейт

### Неподдерживаемый формат
1. Конвертируйте в MP4 с кодеком H.264
2. Используйте ffmpeg или другой конвертер

## Интеграция с Docker

При развертывании через Docker убедитесь, что папка `video_instructions/` монтируется в контейнер:

```yaml
# docker-compose.yml
volumes:
  - .:/app/project
  - ./video_instructions:/app/project/video_instructions
```

## Безопасность

- Видеофайлы не содержат чувствительных данных
- Файлы доступны только через бота
- Нет прямого доступа к файлам через веб-интерфейс
- Рекомендуется регулярно обновлять видеоинструкции

---

*Документация создана: 29.09.2025*
*Версия проекта: 2.31.10*
