{% extends "base.html" %} {% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏{% endblock
%} {% block content %}

<h1>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h1>

<section class="settings-section settings-section--fluid">
	<div class="table-scroll-x">
		<table class="users-table">
			<thead>
				<tr>
					<th class="actions-cell">–ú–µ–Ω—é</th>
					<th>Telegram ID</th>
					<th>Username</th>
					<th>–°—Ç–∞—Ç—É—Å</th>
					<th>–ö–ª—é—á–∏</th>
					<th title="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</th>
					<th>–ë–∞–ª–∞–Ω—Å</th>
					<th>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</th>
				</tr>
			</thead>
			<tbody>
				{% for user in users %}
				<tr class="user-row" data-user-id="{{ user.telegram_id }}" data-username="{{ user.username or 'N/A' }}" data-is-banned="{{ 'true' if user.is_banned else 'false' }}" data-keys-count="{{ user.user_keys|length if user.user_keys else 0 }}">
					<td class="actions-cell">
						<div class="kebab-menu">
							<button type="button" class="kebab-toggle kebab-btn" aria-haspopup="true" aria-expanded="false" title="–î–µ–π—Å—Ç–≤–∏—è">‚ãÆ</button>
							<div class="kebab-dropdown">
								{% if user.is_banned %}
								<form action="{{ url_for('unban_user_route', user_id=user.telegram_id) }}" method="post">
									<button type="submit" class="kebab-item">üü¢üîì –†–∞–∑–±–∞–Ω–∏—Ç—å</button>
								</form>
								{% else %}
								<form action="{{ url_for('ban_user_route', user_id=user.telegram_id) }}" method="post" data-confirm="–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±–∞–Ω–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è? –û–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º.">
									<button type="submit" class="kebab-item">üî¥üîì –ó–∞–±–∞–Ω–∏—Ç—å</button>
								</form>
								{% endif %}
								<form action="{{ url_for('revoke_keys_route', user_id=user.telegram_id) }}" method="post" data-confirm="–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –í–°–ï –∫–ª—é—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–µ—Ä–≤–µ—Ä–æ–≤. –í—ã —É–≤–µ—Ä–µ–Ω—ã?">
									<button type="submit" class="kebab-item kebab-item-danger" {% if not user.user_keys %}disabled title="–ù–µ—Ç –∫–ª—é—á–µ–π"{% endif %}>‚õîüóùÔ∏è –û—Ç–æ–∑–≤–∞—Ç—å –∫–ª—é—á–∏</button>
								</form>
							</div>
						</div>
					</td>
					<td data-field="telegram_id" data-original="{{ user.telegram_id }}">
						<div class="cell-inline">
							<span>{{ hidden_mode and '***' or user.telegram_id }}</span>
						</div>
					</td>
                    <td data-field="username" data-original="@{{ user.username or 'N/A' }}">
                        <div class="cell-inline">
                            <span class="username-text">{{ hidden_mode and '@***' or ('@' ~ (user.username or 'N/A')) }}</span>
                        </div>
                    </td>
					<td>
						{% if user.is_banned %}
						<span class="status-badge status-banned">–ó–∞–±–∞–Ω–µ–Ω</span>
						{% else %}
						<span class="status-badge status-active">–ê–∫—Ç–∏–≤–µ–Ω</span>
						{% endif %}
					</td>
					<td>
						{% if user.user_keys %} {{ user.user_keys | length }} —à—Ç. {% else %}
						0 {% endif %}
					</td>
                    <td>
                        {{ user.notifications_count or 0 }}
                    </td>
					<td class="user-balance" data-user-id="{{ user.telegram_id }}">
						{{ hidden_mode and '*** RUB' or ('%0.2f RUB'|format((user.balance or 0))) }}
					</td>
					<td data-field="earned" class="user-earned" data-user-id="{{ user.telegram_id }}">{{ hidden_mode and '*** RUB' or '–ó–∞–≥—Ä—É–∑–∫–∞...' }}</td>
					
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</section>

{% endblock %}
