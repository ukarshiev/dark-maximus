<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>{% block title %}–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–æ—Ç–æ–º{% endblock %}</title>
		<link
			rel="stylesheet"
			href="{{ url_for('static', filename='css/style.css', v=project_version or '1') }}?t=20241221"
		/>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<!-- Font Awesome Icons -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	</head>
	<body>
		<!-- –ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å –≤ head -->
		<header class="header-panel">
			<button class="header-burger" id="headerBurger" title="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">
				<span></span>
				<span></span>
				<span></span>
			</button>
			<div class="header-title">{% block header_title %}–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è{% endblock %}</div>
		</header>
		
		<div class="container">
			<!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
			<aside class="sidebar" id="sidebar">
				<!-- Header –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é -->
				<div class="menu-items-header">
					<button class="sidebar-burger" id="sidebarBurger" title="–°–∫—Ä—ã—Ç—å –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é">
						<span></span>
						<span></span>
						<span></span>
					</button>
					<div class="sidebar-logo">
						<img src="{{ url_for('static', filename='logo.svg') }}" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo-img">
					</div>
				</div>
				
				<nav class="sidebar-nav">
					<a
						href="{{ url_for('dashboard_page') }}"
						class="nav-link {% if request.endpoint == 'dashboard_page' %}active{% endif %}"
						title="–ì–ª–∞–≤–Ω–∞—è"
					>
						<span class="nav-icon">üè†</span>
						<span class="nav-text">–ì–ª–∞–≤–Ω–∞—è</span>
					</a>
					<a
						href="{{ url_for('users_page') }}"
						class="nav-link {% if request.endpoint == 'users_page' %}active{% endif %}"
						title="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"
					>
						<span class="nav-icon">üë•</span>
						<span class="nav-text">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
					</a>
					<a
						href="{{ url_for('transactions_page') }}"
						class="nav-link {% if request.endpoint == 'transactions_page' %}active{% endif %}"
						title="–ü–ª–∞—Ç–µ–∂–∏"
					>
						<span class="nav-icon">üí≥</span>
						<span class="nav-text">–ü–ª–∞—Ç–µ–∂–∏</span>
					</a>
					<a
						href="{{ url_for('keys_page') }}"
						class="nav-link {% if request.endpoint == 'keys_page' %}active{% endif %}"
						title="–ö–ª—é—á–∏"
					>
						<span class="nav-icon">üîë</span>
						<span class="nav-text">–ö–ª—é—á–∏</span>
					</a>
					<a
						href="{{ url_for('notifications_page') }}"
						class="nav-link {% if request.endpoint == 'notifications_page' %}active{% endif %}"
						title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
					>
						<span class="nav-icon">üîî</span>
						<span class="nav-text">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
					</a>
					<a
						href="{{ url_for('instructions_page') }}"
						class="nav-link {% if request.endpoint == 'instructions_page' %}active{% endif %}"
						title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏"
					>
						<span class="nav-icon">üìô</span>
						<span class="nav-text">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</span>
					</a>
					<a
						href="{{ url_for('settings_page') }}"
						class="nav-link {% if request.endpoint == 'settings_page' %}active{% endif %}"
						title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
					>
						<span class="nav-icon">‚öôÔ∏è</span>
						<span class="nav-text">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
					</a>
				</nav>

				<!-- –°–≤–µ—Ä–Ω—É—Ç–æ–µ –º–µ–Ω—é —Å –∏–∫–æ–Ω–∫–∞–º–∏ -->
				<nav class="sidebar-nav sidebar-nav-collapsed" style="display: none;">
					<!-- –û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
					<div class="sidebar-nav-main">
						<a
							href="{{ url_for('dashboard_page') }}"
							class="nav-link {% if request.endpoint == 'dashboard_page' %}active{% endif %}"
							title="–ì–ª–∞–≤–Ω–∞—è"
						>
							<span class="nav-icon">üè†</span>
						</a>
						<a
							href="{{ url_for('users_page') }}"
							class="nav-link {% if request.endpoint == 'users_page' %}active{% endif %}"
							title="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"
						>
							<span class="nav-icon">üë•</span>
						</a>
						<a
							href="{{ url_for('transactions_page') }}"
							class="nav-link {% if request.endpoint == 'transactions_page' %}active{% endif %}"
							title="–ü–ª–∞—Ç–µ–∂–∏"
						>
							<span class="nav-icon">üí≥</span>
						</a>
						<a
							href="{{ url_for('keys_page') }}"
							class="nav-link {% if request.endpoint == 'keys_page' %}active{% endif %}"
							title="–ö–ª—é—á–∏"
						>
							<span class="nav-icon">üîë</span>
						</a>
						<a
							href="{{ url_for('notifications_page') }}"
							class="nav-link {% if request.endpoint == 'notifications_page' %}active{% endif %}"
							title="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
						>
							<span class="nav-icon">üîî</span>
						</a>
						<a
							href="{{ url_for('instructions_page') }}"
							class="nav-link {% if request.endpoint == 'instructions_page' %}active{% endif %}"
							title="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏"
						>
							<span class="nav-icon">üìô</span>
						</a>
						<a
							href="{{ url_for('settings_page') }}"
							class="nav-link {% if request.endpoint == 'settings_page' %}active{% endif %}"
							title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
						>
							<span class="nav-icon">‚öôÔ∏è</span>
						</a>
					</div>
					
					<!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–≤–Ω–∏–∑—É) -->
					<div class="sidebar-nav-controls">
						<!-- –°–∫—Ä—ã—Ç—ã–π —Ä–µ–∂–∏–º -->
						<div class="nav-link nav-toggle" title="–°–∫—Ä—ã—Ç—ã–π —Ä–µ–∂–∏–º">
							<label class="bot-toggle">
								<input type="checkbox" 
									   class="bot-checkbox"
									   id="hiddenModeToggleCollapsed"
									   {% if hidden_mode %}checked{% endif %}>
								<span class="toggle-slider"></span>
							</label>
						</div>
						<!-- –ë–æ—Ç –≤–∏—Ç—Ä–∏–Ω–∞ -->
						<div class="nav-link nav-toggle" title="–ë–æ—Ç –≤–∏—Ç—Ä–∏–Ω–∞">
							<label class="bot-toggle">
								<input type="checkbox" 
									   class="bot-checkbox" 
									   data-bot="shop"
									   {% if bot_status.shop_bot_running %}checked{% endif %}>
								<span class="toggle-slider"></span>
							</label>
						</div>
						<!-- –ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ -->
						<div class="nav-link nav-toggle" title="–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏">
							<label class="bot-toggle">
								<input type="checkbox" 
									   class="bot-checkbox" 
									   data-bot="support"
									   {% if bot_status.support_bot_running %}checked{% endif %}>
								<span class="toggle-slider"></span>
							</label>
						</div>
						<!-- –í–µ—Ä—Å–∏—è -->
						<a
							href="{{ url_for('dev_page') }}"
							class="nav-link"
							title="–í–µ—Ä—Å–∏—è: {{ project_version or 'N/A' }}"
						>
							<i class="fas fa-server"></i>
						</a>
						<!-- –í—ã–π—Ç–∏ -->
						<form action="{{ url_for('logout_page') }}" method="post" class="nav-link-form">
							<button type="submit" class="nav-link nav-button" title="–í—ã–π—Ç–∏ –∏–∑ –ø–∞–Ω–µ–ª–∏">
								<i class="fas fa-sign-out-alt"></i>
							</button>
						</form>
					</div>
				</nav>

				<!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏ -->
				<div class="bot-controls">
					<div class="bot-control">
						<div class="bot-status">
							<div class="bot-label-row">
								<span class="bot-label">–°–∫—Ä—ã—Ç—ã–π —Ä–µ–∂–∏–º:</span>
								<label class="bot-toggle">
									<input type="checkbox" 
										   class="bot-checkbox"
										   id="hiddenModeToggle"
										   {% if hidden_mode %}checked{% endif %}>
									<span class="toggle-slider"></span>
								</label>
								<span id="hiddenModeStatus" class="bot-status-text {% if hidden_mode %}status-running{% else %}status-stopped{% endif %}">
									{% if hidden_mode %}ON{% else %}OFF{% endif %}
								</span>
							</div>
						</div>
					</div>
					<div class="bot-control">
						<div class="bot-status">
							<div class="bot-label-row">
								<span class="bot-label">–ë–æ—Ç –≤–∏—Ç—Ä–∏–Ω–∞:</span>
                                <label class="bot-toggle">
                                    <input type="checkbox" 
                                           class="bot-checkbox" 
                                           data-bot="shop"
                                           {% if bot_status.shop_bot_running %}checked{% endif %}>
                                    <span class="toggle-slider"></span>
                                </label>
								<span class="bot-status-text {% if bot_status.shop_bot_running %}status-running{% else %}status-stopped{% endif %}">
									{% if bot_status.shop_bot_running %}ON{% else %}OFF{% endif %}
								</span>
							</div>
						</div>
					</div>

					<div class="bot-control">
						<div class="bot-status">
							<div class="bot-label-row">
								<span class="bot-label">–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∞:</span>
								<label class="bot-toggle">
									<input type="checkbox" 
										   class="bot-checkbox" 
										   data-bot="support"
										   {% if bot_status.support_bot_running %}checked{% endif %}>
									<span class="toggle-slider"></span>
								</label>
								<span class="bot-status-text {% if bot_status.support_bot_running %}status-running{% else %}status-stopped{% endif %}">
									{% if bot_status.support_bot_running %}ON{% else %}OFF{% endif %}
								</span>
							</div>
						</div>
					</div>

				<div class="version-block">
					<a href="{{ url_for('dev_page') }}" class="version-info" style="text-decoration: none;" title="–í–µ—Ä—Å–∏—è: {{ project_version or 'N/A' }}">
						<div class="version-text">–í–µ—Ä—Å–∏—è: {{ project_version or 'N/A' }}</div>
					</a>
				</div>

				<div class="user-session-controls">
					<form action="{{ url_for('logout_page') }}" method="post" class="logout-form">
						<button type="submit" class="button button-logout" data-size="sm" title="–í—ã–π—Ç–∏ –∏–∑ –ø–∞–Ω–µ–ª–∏">
							<i class="fas fa-sign-out-alt"></i>
							–í—ã–π—Ç–∏
						</button>
					</form>
				</div>
			</aside>

			<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
			<main class="main-content">
				{% with messages = get_flashed_messages(with_categories=true) %} {% if
				messages %} {% for category, message in messages %}
				<div class="flash flash-{{ category }}">
					<span class="flash-message">{{ message }}</span>
					<button class="flash-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ" title="–ó–∞–∫—Ä—ã—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ">&times;</button>
				</div>
				{% endfor %} {% endif %} {% endwith %}

				{% block content %}{% endblock %}
			</main>
		</div>

		<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
		<div id="userModal" class="modal">
			<div class="modal-content modal-large">
				<div class="modal-header">
					<div class="modal-header-content">
						<div class="modal-user-info">
							<div class="modal-info-column">
								<div class="modal-info-row">
									<span class="modal-info-label">Telegram ID:</span>
									<span id="modalUserId"></span>
									<button class="modal-action-btn" onclick="openTelegramProfile()" title="–ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram">üîó</button>
								</div>
								<div class="modal-info-row">
									<span class="modal-info-label">Username:</span>
									<span id="modalUsername"></span>
									<button class="modal-action-btn" onclick="copyUsername()" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å username">üìã</button>
								</div>
								<div class="modal-info-row">
									<span class="modal-info-label">–°—Ç–∞—Ç—É—Å:</span>
									<span id="modalStatus"></span>
								</div>
							</div>
							<div class="modal-info-column">
								<div class="modal-info-row">
									<span class="modal-info-label">–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–ª—é—á–∏:</span>
									<span id="modalKeys"></span>
								</div>
						<div class="modal-info-row">
							<span class="modal-info-label">–ë–∞–ª–∞–Ω—Å:</span>
							<span id="modalBalance"></span>
						</div>
								<div class="modal-info-row">
									<span class="modal-info-label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ:</span>
									<span id="modalEarned"></span>
								</div>
							</div>
						</div>
					</div>
                    <span class="close" onclick="closeUserModal()" title="–ó–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ">&times;</span>
				</div>
				<div class="modal-body">
					<!-- –í–∫–ª–∞–¥–∫–∏ -->
                    <div class="modal-tabs">
                        <button class="tab-button active" onclick="switchTab('payments')" title="–û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É –ü–ª–∞—Ç–µ–∂–∏">
							<i class="fas fa-credit-card"></i>
							–ü–ª–∞—Ç–µ–∂–∏
						</button>
                        <button class="tab-button" onclick="switchTab('keys')" title="–û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É –ö–ª—é—á–∏">
							<i class="fas fa-key"></i>
							–ö–ª—é—á–∏
						</button>
                        <button class="tab-button" onclick="switchTab('notifications')" title="–û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
							<i class="fas fa-bell"></i>
							–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
						</button>
                    </div>

					<!-- –í–∫–ª–∞–¥–∫–∞: –ü–ª–∞—Ç–µ–∂–∏ -->
					<div id="tab-payments" class="tab-content active">
						<div class="modal-table-container">
							<table class="modal-table">
								<thead>
									<tr>
										<th>ID</th>
										<th>–•–æ—Å—Ç</th>
										<th>–ü–ª–∞–Ω</th>
										<th>–¶–µ–Ω–∞</th>
										<th>–°—Ç–∞—Ç—É—Å</th>
										<th>–î–∞—Ç–∞</th>
									</tr>
								</thead>
								<tbody id="modalPaymentsTable">
									<!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
								</tbody>
							</table>
						</div>
					</div>

					<!-- –í–∫–ª–∞–¥–∫–∞: –ö–ª—é—á–∏ -->
                    <div id="tab-keys" class="tab-content">
						<div class="modal-table-container">
							<table class="modal-table">
								<thead>
									<tr>
										<th>ID</th>
										<th>–•–æ—Å—Ç</th>
										<th>–ü–ª–∞–Ω</th>
										<th>–°—Ç–æ–∏–º–æ—Å—Ç—å</th>
										<th>–ö–ª—é—á</th>
										<th>–î–∞—Ç–∞</th>
									</tr>
								</thead>
								<tbody id="modalKeysTable">
									<!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
								</tbody>
                            </table>
                        </div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                    <div id="tab-notifications" class="tab-content">
                        <div class="modal-table-container">
                            <table class="modal-table">
                                <thead>
                                    <tr>
                                        <th title="–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">ID</th>
                                        <th title="–¢–∏–ø –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">–¢–∏–ø</th>
                                        <th title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">–ó–∞–≥–æ–ª–æ–≤–æ–∫</th>
                                        <th title="–°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">–°—Ç–∞—Ç—É—Å</th>
                                        <th title="–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏">–î–∞—Ç–∞</th>
                                    </tr>
                                </thead>
                                <tbody id="modalNotificationsTable">
                                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
				</div>
                <div class="modal-footer">
                    <button id="banButton" class="button button-danger" onclick="banUser()" style="display: none;" title="–ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        –ë–∞–Ω
                    </button>
                    <button id="unbanButton" class="button button-start" onclick="unbanUser()" style="display: none;" title="–û—Ç–æ–∑–≤–∞—Ç—å –±–∞–Ω —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        –û—Ç–æ–∑–≤–∞—Ç—å –±–∞–Ω
                    </button>
                    <button id="revokeButton" class="button button-danger" onclick="revokeKeys()" title="–û—Ç–æ–∑–≤–∞—Ç—å –≤—Å–µ –∫–ª—é—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        –û—Ç–æ–∑–≤–∞—Ç—å –∫–ª—é—á–∏
                    </button>
                </div>
			</div>
		</div>

		<script src="{{ url_for('static', filename='js/script.js') }}"></script>
	</body>
</html>
