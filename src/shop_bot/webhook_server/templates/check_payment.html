{% extends "base.html" %}
{% block title %}–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π{% endblock %}
{% block content %}

<h1>–ü—Ä–æ–≤–µ—Ä–∫–∞ TON –ø–ª–∞—Ç–µ–∂–µ–π</h1>

<div class="form-container">
    <form method="POST">
        <div class="form-group">
            <label for="tx_hash">–•–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (Transaction Hash):</label>
            <input type="text" id="tx_hash" name="tx_hash" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" required>
        </div>
        <button type="submit" class="button">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–ª–∞—Ç–µ–∂</button>
    </form>
</div>

{% if result %}
    <div class="result-container">
        {% if result.success %}
            <h2>‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</h2>
            <div class="payment-info">
                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="status-success">–£—Å–ø–µ—à–Ω–æ</span></p>
                <p><strong>–°—É–º–º–∞:</strong> {{ result.amount_ton }} TON</p>
                <p><strong>–•–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</strong> <code>{{ result.data.hash }}</code></p>
                <p><strong>–í—Ä–µ–º—è:</strong> {{ result.data.utime | int | timestamp_to_datetime }}</p>
                
                {% if result.data.in_msg %}
                    <h3>–î–µ—Ç–∞–ª–∏ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:</h3>
                    <ul>
                        <li><strong>–û—Ç:</strong> {{ result.data.in_msg.source.address }}</li>
                        <li><strong>–ö:</strong> {{ result.data.in_msg.destination.address }}</li>
                        <li><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> {{ result.data.in_msg.get('decoded_comment', '–ù–µ—Ç') }}</li>
                    </ul>
                {% endif %}
                
                <h3>–°—Å—ã–ª–∫–∏:</h3>
                <p>
                    <a href="https://tonapi.io/v2/blockchain/transactions/{{ result.data.hash }}" target="_blank" class="button">
                        üîó TON API
                    </a>
                    <a href="https://tonscan.org/tx/{{ result.data.hash }}" target="_blank" class="button">
                        üîó TON Explorer
                    </a>
                </p>
            </div>
        {% else %}
            <h2>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</h2>
            <div class="error-info">
                <p><strong>–û—à–∏–±–∫–∞:</strong> {{ result.error }}</p>
            </div>
        {% endif %}
    </div>
{% endif %}

<div class="help-section">
    <h2>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</h2>
    <ol>
        <li>–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Å—ã–ª–∫—É TON Connect –≤ Telegram</li>
        <li>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –∫–æ—à–µ–ª—å–∫–µ</li>
        <li>–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ö–µ—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
        <li>–ò–ª–∏ –Ω–∞–π–¥–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ <a href="https://tonscan.org" target="_blank">TON Explorer</a></li>
    </ol>
    
    <h3>–ü—Ä–∏–º–µ—Ä —Ö–µ—à–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</h3>
    <code>1467ff202993a55945ae4752ba17e24e7d3a5d7c944603b0b9b45b24e3a1c584</code>
</div>

<style>
.result-container {
    margin-top: 30px;
    padding: 20px;
    background: #1a1a1a;
    border-radius: 8px;
    border: 1px solid #333;
}

.payment-info {
    background: #2a2a2a;
    padding: 15px;
    border-radius: 6px;
    margin: 15px 0;
}

.status-success {
    color: #4CAF50;
    font-weight: bold;
}

.error-info {
    background: #3a1a1a;
    padding: 15px;
    border-radius: 6px;
    margin: 15px 0;
    border-left: 4px solid #f44336;
}

.help-section {
    margin-top: 40px;
    padding: 20px;
    background: #1a1a1a;
    border-radius: 8px;
    border: 1px solid #333;
}

.help-section ol {
    margin: 15px 0;
    padding-left: 20px;
}

.help-section code {
    background: #333;
    padding: 4px 8px;
    border-radius: 4px;
    font-family: monospace;
    color: #fff;
}

.form-container {
    margin: 30px 0;
    padding: 20px;
    background: #1a1a1a;
    border-radius: 8px;
    border: 1px solid #333;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    color: #fff;
    font-weight: 500;
}

.form-group input {
    width: 100%;
    padding: 12px;
    background: #2a2a2a;
    border: 1px solid #555;
    border-radius: 6px;
    color: #fff;
    font-size: 14px;
}

.form-group input:focus {
    outline: none;
    border-color: #007bff;
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
}
</style>

{% endblock %}
