# –°–≤–æ–¥–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Timezone Support

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ —Å–º–µ–Ω—ã —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –Ω–∞ **UTC+12 (–û–∫–ª–µ–Ω–¥)** –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—é—á–∞—Ö –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ **UTC+3**:

```
‚ûï –ü—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω: 07.11.2025 –≤ 10:17 (UTC+3)
‚è≥ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ: 07.11.2025 –≤ 11:17 (UTC+3)
```

**–û–∂–∏–¥–∞–ª–æ—Å—å:**
```
‚ûï –ü—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω: 07.11.2025 –≤ 20:17 (UTC+13)
‚è≥ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ: 07.11.2025 –≤ 21:17 (UTC+13)
```

## üîç –ü—Ä–∏—á–∏–Ω—ã

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ tzdata** ‚Äî –Ω–∞ Windows –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –ø–∞–∫–µ—Ç `tzdata`, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è —Ä–∞–±–æ—Ç—ã `zoneinfo`
2. **–î—É–±–ª–∏–∫–∞—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π** ‚Äî –≤ `database.py` –±—ã–ª–∏ –¥–≤–µ –≤–µ—Ä—Å–∏–∏ `set_user_timezone` –∏ `get_user_timezone`
3. **Feature flag –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω** ‚Äî –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –µ–≥–æ –Ω—É–∂–Ω–æ –±—ã–ª–æ –≤–∫–ª—é—á–∏—Ç—å

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å tzdata

**–§–∞–π–ª:** `pyproject.toml`

```toml
dependencies = [
    ...
    "tzdata>=2025.2"
]
```

### 2. –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π

**–§–∞–π–ª:** `src/shop_bot/data_manager/database.py`

–£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π (—Å—Ç—Ä–æ–∫–∏ 5137-5160):
- `set_user_timezone()` 
- `get_user_timezone()`

–û—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π (—Å—Ç—Ä–æ–∫–∏ 2225-2250, 2197-2222).

### 3. –í–∫–ª—é—á—ë–Ω feature flag

```bash
UPDATE bot_settings SET value = '1' WHERE key = 'feature_timezone_enabled';
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è

- `pyproject.toml`: `3.17.2` ‚Üí `3.17.3`
- `CHANGELOG.md`: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ:

```bash
python tests/final_timezone_verification.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ Feature timezone enabled: True
- ‚úÖ tzdata —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Timezone –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–µ–Ω—è–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç: `07.11.2025 –≤ 20:17 (UTC+13)` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
- ‚úÖ `get_key_info_text()` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π UTC offset

## üìã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±–æ—Ç–µ

### –®–∞–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. **–ú–µ–Ω—é** ‚Üí **üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å**
3. –ù–∞–∂–º–∏—Ç–µ **üåç –ò–∑–º–µ–Ω–∏—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å**
4. –í—ã–±–µ—Ä–∏—Ç–µ **Pacific/Auckland (UTC+12)**
5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤—ã–±–æ—Ä
6. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ø—Ä–æ—Ñ–∏–ª—å ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –∏–∑–º–µ–Ω–∏–ª—Å—è
7. **–ú–µ–Ω—é** ‚Üí **üîë –ú–æ–∏ –∫–ª—é—á–∏** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π –∫–ª—é—á
8. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—Ç—ã ‚Äî –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ UTC+12/+13

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

‚úÖ –î–∞—Ç—ã "–ü—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω" –∏ "–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ" –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º timezone  
‚úÖ UTC offset –≤ —Å–∫–æ–±–∫–∞—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É timezone  
‚úÖ –†–∞–∑–Ω–∏—Ü–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, UTC+3 ‚Üí UTC+13 = +10 —á–∞—Å–æ–≤)

## üì¶ Deployment

–î–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–¥–∞–∫—à–Ω:

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install tzdata

# 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
npx nx stop bot
npx nx serve bot

# 3. Feature flag —É–∂–µ –≤–∫–ª—é—á—ë–Ω –≤ –ë–î
```

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `pyproject.toml` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `tzdata>=2025.2`
2. `src/shop_bot/data_manager/database.py` ‚Äî —É–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π
3. `CHANGELOG.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–ø–∏—Å—å –≤–µ—Ä—Å–∏–∏ 3.17.3
4. `tests/` ‚Äî —Å–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:
   - `check_timezone_feature.py`
   - `enable_timezone_feature.py`
   - `test_timezone_change.py`
   - `final_timezone_verification.py`

## ‚ú® –°—Ç–∞—Ç—É—Å

**‚úÖ –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê**

Timezone support —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ü–æ—Å–ª–µ —Å–º–µ–Ω—ã —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –≤—Å–µ –¥–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º timezone —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º UTC offset.

---

**–í–µ—Ä—Å–∏—è:** 3.17.3  
**–î–∞—Ç–∞:** 07.11.2025 10:36  
**–ê–≤—Ç–æ—Ä:** AI Assistant

