# История изменений

2.30.11 – 26.09.2025
- [Исправление] (API) Исправлены ошибки типизации в модуле xui_api.py
  - Исправлен доступ к reality_settings в функции get_connection_string с проверкой типов
  - Добавлена обработка случаев, когда stream_settings является строкой JSON
  - Исправлено использование setattr для атрибута comment в классе Client
  - Убраны неподдерживаемые параметры из конструктора Client (expiry_time)
  - Исправлены типы параметров в вызовах api.client.delete и api.client.update
  - Добавлены проверки типов для server_names и short_ids перед обращением к элементам

2.30.10 – 26.09.2025
- [Исправление] (Дашборд) Исправлена stat-card "Всего заработано" для корректного отображения заработанных средств
  - Заменена функция get_total_spent_sum() на get_total_earned_sum()
  - Теперь суммируются только успешные транзакции (status = 'completed') из таблицы transactions
  - Добавлено логирование для всех функций статистики для отладки
  - Улучшена обработка null-значений в шаблоне dashboard.html

2.30.9 – 26.09.2025
- [Улучшение] (Ключи) Доработана функция toggleKeyEnabled для немедленного завершения ключей при отключении
  - При отключении ключа remaining_seconds теперь устанавливается на 0 (текущее время)
  - В 3x-ui API атрибут expiryTime обновляется на текущее время в миллисекундах
  - Ключ сразу заканчивается и становится неактивным при отключении
  - Обновлены функции update_key_enabled_status и update_client_enabled_status_on_host

2.30.8 – 26.09.2025
- [Удаление] (Отзыв триала) Удален функционал отзыва триала
  - Удалена кнопка "Отозвать триал" из интерфейса пользователей
  - Удален маршрут /users/revoke-trial/<int:user_id>
  - Удалены функции toggleKeyEnabled и disableKey из xui_api.py
  - Оставлен только функционал "Повторный триал" для сброса флага trial_used

2.30.7 – 26.09.2025
- [Исправление] (Логика триалов) Исправлена логика работы с повторными триалами
  - Исправлена проверка в кнопке "Пробный период": теперь учитывается trial_reuses_count
  - Пользователи с trial_used=1 и trial_reuses_count>0 могут получить повторный триал
  - При создании триального ключа теперь увеличивается trial_reuses_count
  - Обновлена документация с диаграммой логики работы триалов
  - Логика "Повторный триал" осталась без изменений (trial_used=0, trial_reuses_count+1)

2.30.6 – 26.09.2025
- [Исправление] (Пользователи) Исправлено отображение колонки "Триал" в таблице пользователей
  - Добавлены поля trial_days_given и trial_reuses_count в SQL-запрос функции get_all_users()
  - Колонка "Триал" теперь отображает формат: "trial_used-trial_days_given-trial_reuses_count" (например: 1-3-0)
  - Добавлен tooltip "Исп-дней-повтор" для понимания формата данных
  - Исправлена проблема, когда колонка "Триал" показывала "—" несмотря на наличие данных в БД
  - Изменено условие отображения кнопки "Повторный триал": теперь показывается для пользователей с trial_used = 1
- [Исправление] (Триал) Исправлена функция "Отозвать триал" для корректной работы с 3x-ui
  - Функция теперь работает только с триальными ключами (is_trial = 1), а не со всеми ключами пользователя
  - Добавлено правильное отключение ключей в 3x-ui панелях (enabled = false) через update_client_enabled_status_on_host
  - Исправлена асинхронная обработка вызовов API 3x-ui через event loop
  - Улучшено логирование процесса отзыва триала с детализацией по каждому ключу

2.30.5 – 25.09.2025 23:59
- [Исправление] (Ключи) Исправлена функция "Отозвать ключи" в панели администратора
  - Добавлена передача xui_client_uuid для более надежного удаления ключей из 3x-ui
  - Реализован двухэтапный подход: сначала удаление по UUID с конкретного хоста, затем fallback через общую функцию
  - Улучшено логирование процесса удаления ключей с детализацией по каждому этапу
  - Исправлена проблема, когда ключи оставались включенными в 3x-ui после отзыва
  - Добавлена проверка успешности удаления перед удалением из базы данных

2.30.4 – 25.09.2025 23:58
- [Улучшение] (UI/UX) Перенесен функционал сброса триала в модальное окно на странице пользователей
  - Удалена отдельная страница admin_trial_reset.html из бокового меню
  - Добавлена кнопка "Сбросить триал" в header-panel-right на странице пользователей
  - Создано модальное окно с поиском пользователей и подтверждением действия
  - Обновлен API endpoint для поддержки JSON запросов от модального окна
  - Добавлены функции JavaScript для работы с новым модальным окном
  - Улучшен пользовательский опыт: теперь сброс триала доступен прямо из списка пользователей

2.30.3 – 25.09.2025 23:55
- [Исправление] (Триал) Исправлена функция отзыва триала в панели администратора
  - Добавлено обновление квоты трафика на 1 МБ при отзыве триала
  - Исправлена логика определения статуса ключа при обновлении из 3x-ui
  - Теперь отозванные триалы корректно отображаются как "deactivate" даже после обновления
  - Добавлена проверка квоты трафика для определения отозванного триала (≤ 0.001 ГБ)
  - Улучшено логирование процесса отзыва триала с детализацией по каждому ключу

2.30.2 – 25.09.2025 23:50
- [Улучшение] (Ключи) Добавлено визуальное отображение статуса ключей
  - Добавлены иконки ✅/❌ для отображения статуса ключей в списке
  - Добавлена строка статуса в карточку ключа с русскоязычным описанием
  - Создана функция get_status_icon_and_text для определения иконки и текста статуса
  - Обновлена функция get_key_info_text для отображения статуса ключа
  - Обновлена функция create_keys_management_keyboard для использования статуса из БД
  - Обновлена функция update_key_status_from_server для сохранения статуса в БД
  - Статусы: trial-active → "Пробный активный", trial-ended → "Пробный закончился", pay-active → "Платный активный", pay-ended → "Платный закончился", deactivate → "Деактивирован"

2.30.1 – 25.09.2025 23:45
- [Исправление] (Триал) Исправлена логика проверки активных пробных ключей
  - Добавлена проверка статуса ключа при определении активных триальных ключей
  - Деактивированные ключи (status='Деактив') больше не блокируют создание нового триала
  - Исправлена проверка в handlers.py для кнопки "Пробный период"
  - Исправлена проверка в шаблоне users.html для корректного отображения
  - Теперь система правильно различает активные и деактивированные триальные ключи

2.30.0 – 25.09.2025 23:30
- [Исправление] (Триал) Исправлены критические проблемы с системой триалов
  - Исправлено изменение статуса на 'Деактив' при отзыве триала
  - Исправлена логика повторного использования триала - теперь проверяется статус ключа
  - Исправлено заполнение атрибутов БД при выдаче триала (plan_name, price, status, enabled)
  - Добавлена функция update_key_status для обновления статуса ключей
  - Улучшена логика проверки активных триальных ключей с учетом статуса
  - Триальные ключи теперь корректно заполняют все поля в базе данных

2.29.6 – 25.09.2025 22:55
- [Изменение] (Триал) Изменена логика отзыва триала - теперь отключается ключ вместо установки квоты
  - Упрощена логика отзыва триала - используется существующий функционал отключения ключей
  - Убрана сложная логика обновления квоты через API панели
  - Повышена надежность отзыва триала
  - Обновлено сообщение об успешном отзыве триала

2.29.5 – 25.09.2025 22:50
- [Исправление] (Квота) Улучшена обработка ошибок при обновлении квоты через API панели
  - Добавлена детальная обработка ошибок JSON парсинга
  - Добавлен fallback на py3xui если API панели не работает
  - Улучшено логирование для отладки проблем с API панели
  - Добавлена проверка содержимого ответа при ошибках

2.29.4 – 25.09.2025 22:45
- [Исправление] (Квота) Переписана функция обновления квоты трафика для работы через API панели
  - Добавлена функция _panel_update_client_quota для нативного обновления через API панели
  - Добавлена функция update_client_quota_on_host для обновления квоты на конкретном хосте
  - Функция отзыва триала теперь использует API панели вместо py3xui
  - Исправлен формат данных для отправки в 3x-ui (application/x-www-form-urlencoded)
  - Обновляется весь inbound со всеми клиентами, а не только один клиент
  - Добавлена корректная обработка статистики клиентов (clientStats)

2.29.3 – 25.09.2025 22:40
- [Исправление] (Ключи) Исправлена передача статуса включения/отключения в 3x-ui панели
  - Переписана функция _panel_update_client_enabled_status для корректной работы с API панели
  - Теперь обновляется весь inbound со всеми клиентами, а не только один клиент
  - Исправлен формат данных для отправки в 3x-ui (application/x-www-form-urlencoded)
  - Добавлена корректная обработка статистики клиентов (clientStats)
  - Функция теперь возвращает boolean для проверки успешности операции

2.29.2 – 25.09.2025 22:35
- [Исправление] (Квота) Исправлена передача квоты трафика в 3x-ui панели
  - Исправлено поле totalGB: теперь передается в байтах, а не в гигабайтах
  - Поле total и totalGB теперь содержат одинаковые значения в байтах
  - Исправлена установка квоты при отзыве триала (1 МБ корректно отображается в панели)

2.29.1 – 25.09.2025 22:30
- [Исправление] (Ключи) Исправлена передача статуса включения/отключения в 3x-ui панели
  - Добавлена функция _panel_update_client_enabled_status для использования нативного эндпоинта панели
  - Исправлена передача поля "enable" в JSON payload для корректного обновления статуса клиента
  - Улучшена совместимость с различными версиями 3x-ui панелей

2.29.0 – 25.09.2025 22:20
- [Новый функционал] (Ключи) Добавлена возможность включения/отключения ключей в 3x-ui панелях
  - Добавлена колонка "Вкл" в таблице ключей для отображения статуса включения
  - Добавлены кнопки "Включить"/"Отключить" в кебаб меню каждого ключа
  - Реализована синхронизация статуса включения между базой данных и 3x-ui панелями
  - Добавлен API эндпоинт /api/toggle-key-enabled для переключения статуса
  - Добавлены функции update_key_enabled_status и get_key_enabled_status в database.py
  - Добавлена функция update_client_enabled_status_on_host в xui_api.py
  - При обновлении ключей из 3x-ui автоматически синхронизируется статус включения
  - Добавлено поле 'enabled' в таблицу vpn_keys с миграцией

2.28.8 – 25.09.2025 22:15
- [Исправление] (Триал) Исправлена логика отзыва триала пользователя
  - При отзыве триала теперь сбрасывается флаг trial_used в базе данных
  - Пользователь может получить новый триал после отзыва предыдущего
  - Исправлена проблема с сообщением "Вы уже использовали бесплатный пробный период"
  - Исправлена установка квоты трафика: теперь корректно устанавливается "Общее" поле (1 МБ) вместо "остаток"

2.28.7 – 25.09.2025 22:10
- [Улучшение] (UI) Добавлено отображение плана "Триал" для триальных ключей в интерфейсе
  - В таблице ключей: триальные ключи теперь отображают "Триал" вместо "N/A" в колонке "План"
  - В таблице платежей: добавлена поддержка отображения "Триал" для транзакций триальных ключей
  - В карточке пользователя: ключи с флагом is_trial=1 отображают план "Триал"
  - Обновлен API /api/user-keys для включения поля is_trial в ответ
  - Улучшена логика определения типа плана на основе флага is_trial

2.28.6 – 25.09.2025 22:05
- [Исправление] (UI) Исправлена функция копирования email ключей в таблице ключей
  - Добавлен fallback для случаев, когда Clipboard API недоступен (HTTP без HTTPS)
  - Улучшена функция copyKey с поддержкой старых браузеров через document.execCommand
  - Добавлены уведомления об успешном/неуспешном копировании
  - Функция теперь работает как в безопасном (HTTPS), так и в небезопасном (HTTP) контексте
  - Исправлена ошибка "Unexpected end of input" при копировании ключей с специальными символами
  - Улучшено экранирование кавычек в JavaScript для предотвращения синтаксических ошибок
  - Исправлен z-index уведомлений (увеличен с 1000 до 10000) для отображения поверх header-panel

2.28.5 – 25.09.2025 22:01
- [Исправление] (XUI API) Исправлена передача квоты трафика при отзыве триала
  - Теперь используется тот же механизм, что и при создании ключей - update_or_create_client_on_panel
  - Исправлена проблема с несинхронизацией квоты между базой данных и 3x-ui панелью
  - Добавлено прямое подключение к хосту и обновление через API вместо отдельной функции
  - Улучшено логирование процесса отзыва триала для отладки

2.28.4 – 25.09.2025 22:00
- [Исправление] (Панель администратора) Исправлено отображение колонки "Триал" в таблице ключей
  - Добавлено поле is_trial в запрос get_paginated_keys для корректного отображения
  - Улучшено отображение: "Да" для триальных ключей (is_trial=1), "Нет" для обычных
  - Используются цветные бейджи для лучшей визуализации статуса триала

2.28.3 – 25.09.2025 21:50
- [Исправление] (XUI API) Исправлена синхронизация квоты трафика при отзыве триала
  - Теперь при отзыве триала квота корректно передается в 3x-ui панель
  - Добавлено обновление полей total, totalGB, up, down для полной синхронизации
  - Используется тройной механизм обновления: inbound.update + client.update + panel endpoint
  - Улучшено логирование процесса отзыва триала для отладки
- [Улучшение] (Панель администратора) Улучшено отображение результатов отзыва триала
  - Добавлена детальная информация о неудачных обновлениях ключей
  - Улучшено логирование процесса обработки каждого ключа

2.28.2 – 25.09.2025 21:15
- [Исправление] (Панель администратора) Исправлено отображение колонки "Триал" в списке пользователей
  - Теперь колонка корректно показывает информацию о триале на основе активных триальных ключей
  - Добавлена проверка наличия активных ключей с is_trial=1 и remaining_seconds>0
- [Исправление] (XUI API) Исправлена передача комментария с userid в 3x-ui панель
  - Комментарий теперь корректно передается при создании и обновлении клиентов
  - Исправлена логика установки комментария в client_payload и при создании новых клиентов

2.28.1 – 25.09.2025 21:09
- [Исправление] (XUI API) Исправлена ошибка "Inbound object has no attribute 'clients'" при отзыве триала
  - Заменен неправильный доступ к клиентам через inbound.clients на корректный через api.inbound.get_by_id().settings.clients
  - Исправлен способ обновления квоты клиента через api.inbound.update вместо api.client.update
  - Улучшена обработка ошибок при работе с клиентами на панелях XUI

2.28.0 – 25.09.2025
- [Техническое] (Шаблоны ключей) Изменены шаблоны создания ключей:
  - Триальные ключи: email теперь `user{user_id}-key{key_number}-trial@{host_code}.bot`, comment = `{user_id}`
  - Боевые ключи: comment теперь `{user_id}` (email остается `user{user_id}-key{key_number}@{host_code}.bot`)
  - Улучшена консистентность и читаемость идентификаторов ключей в системе

2.27.0 – 26.12.2025 12:00
- [Новый функционал] (Админ-панель) Добавлен пункт "Сбросить триал" в главное меню админ-панели для полного сброса информации о триале пользователей
- [Новый функционал] (Telegram бот) Добавлена функция сброса триала в админ-панели бота с пошаговым процессом ввода ID и подтверждения
- [Новый функционал] (База данных) Реализована функция admin_reset_trial_completely для полного сброса всех полей триала (trial_used, trial_days_given, trial_reuses_count)
- [Новый функционал] (Веб-интерфейс) Создана страница /admin/trial-reset с формой ввода Telegram ID пользователя и подтверждением операции
- [Новый функционал] (API) Добавлены маршруты GET и POST /admin/trial-reset для отображения страницы и обработки сброса триала
- [Улучшение UX] (Форма) Добавлена валидация ввода, подтверждение операции и индикатор загрузки при выполнении сброса
- [Техническое] (Безопасность) Функция доступна только авторизованным администраторам через декоратор @login_required

2.26.0 – 25.09.2025 21:00
- [Новый функционал] (Управление пользователями) Добавлена колонка "Триал" в таблицу пользователей с отображением количества дней и повторных использований
- [Новый функционал] (Управление пользователями) Добавлены кнопки "Отозвать триал" и "Повторный триал" в кебаб меню пользователей
- [Новый функционал] (База данных) Добавлены поля trial_days_given и trial_reuses_count в таблицу users для отслеживания пробного периода
- [Новый функционал] (API) Добавлена функция update_client_quota_on_host для управления квотой трафика клиентов
- [Новый функционал] (Обработчики) Реализована логика отзыва триала с установкой квоты на 1 МБ
- [Новый функционал] (Обработчики) Реализована логика повторного использования триала с увеличением счетчика
- [Техническое] (Миграция) Добавлена автоматическая миграция базы данных для новых полей триала
- [Техническое] (UI) Обновлен интерфейс таблицы пользователей с поддержкой отображения информации о триале

2.25.19 – 25.09.2025 20:15
- [Исправление] (Главное меню) Добавлена кнопка "Пробный период" в главное меню бота с проверкой настройки trial_enabled
- [Новый функционал] (UI) Кнопка "Пробный период" отображается только при включенной настройке "Включить пробный период" в админ-панели
- [Исправление] (Обработчики) Добавлен обработчик trial_period_message_handler для кнопки "Пробный период" из главного меню
- [Техническое] (Клавиатуры) Обновлена функция get_main_reply_keyboard для динамического отображения кнопки пробного периода

2.25.18 – 25.09.2025 20:00
- [Исправление] (Обработчики) Исправлены ошибки типизации с int() и get_setting в handlers.py: добавлены проверки на None для предотвращения ошибок при преобразовании типов
- [Техническое] (Безопасность) Улучшена обработка случаев, когда настройки бота возвращают None вместо ожидаемых значений
- [Исправление] (Обработчики) Исправлены ошибки с metadata.get() и int() в функциях обработки платежей
- [Техническое] (API) Добавлены значения по умолчанию для всех случаев использования get_setting с числовыми преобразованиями

2.25.17 – 25.09.2025 19:30
- [Исправление] (Обработчики) Исправлена ошибка типизации в support_handler: добавлена проверка на None для support_url перед передачей в create_support_keyboard
- [Техническое] (Безопасность) Улучшена обработка случаев, когда информация о поддержке не настроена в админ-панели

2.25.16 – 25.09.2025 19:15
- [Исправление] (База данных) Исправлена функция set_terms_agreed в database.py: добавлен параметр agreed для возможности сброса статуса согласия с условиями
- [Техническое] (API) Функция set_terms_agreed теперь принимает два параметра: telegram_id и agreed (по умолчанию True)
- [Исправление] (Обработчики) Исправлена ошибка "Expected 1 positional argument" в команде reset_terms в handlers.py

2.25.15 – 25.09.2025 18:30
- [Исправление] (Типизация) Исправлены критические проблемы с типизацией в handlers.py: добавлена безопасная обработка None значений для admin_id, user_data и других переменных
- [Техническое] (Pyright) Обновлена конфигурация Pyright для корректной работы с виртуальным окружением и уменьшения ложных предупреждений
- [Исправление] (Импорты) Исправлен отсутствующий импорт update_user в handlers.py
- [Техническое] (Функции) Переименованы дублирующиеся функции: about_handler → help_handler, show_instruction_handler → show_instruction_general_handler, process_successful_onboarding → process_successful_onboarding_v2
- [Улучшение] (Безопасность) Добавлена вспомогательная функция get_admin_id() для безопасного получения ID администратора с проверкой на None
- [Статистика] (Качество кода) Сокращено количество ошибок линтера с 101 до 82 (уменьшение на 19%)

2.25.14 – 25.09.2025 18:08
- [Документация] (Настройки) Добавлена документация по настройке уведомлений GitHub для решения проблемы множественных email-уведомлений после пуша
- [Исправление] (CI/CD) Обновлена версия aiohttp с 3.9.5 до 3.12.15 для совместимости с Dependabot
- [Улучшение] (Разработка) Добавлена документация по отключению нежелательных уведомлений от GitHub Actions, Dependabot и других сервисов

2.25.13 – 25.09.2025 17:00
- [Улучшение] (UI/Навигация) Убрано дублирование главного меню: удалена inline-клавиатура главного меню, оставлена только ReplyKeyboardMarkup для единообразной навигации
- [Техническое] (Клавиатуры) Удалена функция create_main_menu_keyboard из keyboards.py
- [Техническое] (Обработчики) Обновлена функция show_main_menu для использования только ReplyKeyboardMarkup
- [Техническое] (Обработчики) Обновлен обработчик back_to_main_menu_handler для корректного перехода к главному меню без inline-клавиатуры
- [Исправление] (UI/Сообщения) Исправлено дублирование сообщений при нажатии кнопки "Назад в меню" - теперь отправляется только одно сообщение

2.25.12 – 25.09.2025 16:15
- [Улучшение] (UI/Навигация) Перемещен пункт "О проекте" из главного меню в раздел "Помощь и поддержка" для улучшения структуры навигации
- [Техническое] (Клавиатуры) Обновлена раскладка главного меню: убрана кнопка "О проекте" из inline-клавиатуры и Reply-клавиатуры
- [Техническое] (Клавиатуры) Добавлена кнопка "О проекте" в клавиатуру раздела "Помощь и поддержка"

2.25.11 – 25.09.2025 16:00
- [Исправление] (Разработка/IDE) Исправлена проблема с импортом модуля requests в app.py: пересоздано виртуальное окружение и установлены все зависимости
- [Техническое] (Конфигурация) Добавлены файлы конфигурации для IDE: .vscode/settings.json и pyrightconfig.json для корректной работы с виртуальным окружением
- [Техническое] (Зависимости) Установлены все зависимости проекта в виртуальное окружение venv с использованием pip install -e .

2.25.10 – 25.09.2025 15:30
- [Исправление] (Настройки/Ton Connect) Исправлена проблема с отображением URL приложения в форме редактирования манифеста: устранен конфликт дублирующихся ID полей в HTML
- [Техническое] (Frontend) Изменен ID поля "URL приложения" с ton_manifest_url на app_url для устранения конфликта с полем "Ton manifest"
- [Техническое] (Backend) Обновлены серверные обработчики для работы с новым именем поля app_url вместо ton_manifest_url
- [Техническое] (База данных) Обновлена функция get_ton_manifest для корректного чтения URL приложения из поля app_url

2.25.9 – 25.09.2025 15:00
- [Новый функционал] (Настройки/Ton Connect) Добавлена загрузка иконки через веб-интерфейс: теперь можно загружать изображения напрямую в админке вместо указания URL
- [Улучшение UX] (Ton Connect) Добавлено превью иконки с индикатором загрузки и валидацией форматов файлов (PNG, JPG, JPEG, GIF, WEBP)
- [Улучшение API] (Файлы) Создан эндпоинт /upload-ton-icon для загрузки иконок с автоматическим сохранением в папку /static/icons/
- [Исправление] (Ton Connect) Исправлена генерация URL для загруженных иконок: теперь используется полный URL с доменом вместо относительного пути
- [Исправление] (Настройки/Платежные системы) Унифицирован функционал Ton Connect манифеста: кнопки "Перейти к манифесту" и "Редактировать манифест" теперь используют единый функционал из вкладки "Бот"
- [Улучшение UI] (Настройки) Удален дублирующий блок "Ton Connect Manifest" из вкладки "Бот": весь функционал теперь доступен через кнопку "Редактировать манифест TON Connect" во вкладке "Платежные системы"
- [Исправление] (Ton Connect) Исправлена проблема с отображением устаревших данных в форме редактирования: теперь при каждом открытии формы загружаются актуальные данные из базы данных через API
- [Исправление] (Ton Connect) Исправлена проблема с отображением "URL приложения" в форме редактирования: добавлена дополнительная отладка и проверка существования полей формы

2.25.8 – 25.09.2025 14:30
- [Новый функционал] (Настройки/Ton Connect) Добавлена возможность редактирования Ton Connect манифеста через админку: название, URL, иконка, условия использования и политика конфиденциальности теперь настраиваются через модальное окно во вкладке "Бот"
- [Улучшение архитектуры] (База данных) Добавлены настройки Ton manifest в таблицу bot_settings: ton_manifest_name, ton_manifest_url, ton_manifest_icon_url, ton_manifest_terms_url, ton_manifest_privacy_url
- [Улучшение API] (Ton Connect) Маршрут /.well-known/tonconnect-manifest.json теперь генерируется динамически из настроек базы данных вместо статического файла

2.25.7 – 25.09.2025 14:00
- [Исправление ошибки] (Настройки/Платежные системы) Исправлена проблема с пустым полем при редактировании манифеста TON Connect: добавлены недостающие роуты `/api/get-ton-manifest-content` и `/edit-ton-manifest` для загрузки и сохранения содержимого манифеста

2.25.6 – 25.09.2025 13:30
- [Улучшение UI] (Настройки/Тарифы) В таблице тарифов добавлена колонка ID перед «Название» для удобной идентификации тарифов
- [Исправление ошибки] (Настройки/Тарифы) При редактировании тарифа корректно сохраняются часы; добавлена обработка `hours` при создании и редактировании

2.25.5 – 25.09.2025 13:10
- [Исправление ошибки] (Users) Удалены сложные inline-выражения в `users.html`: вызовы заменены на хелперы `openUserModalFromElement` и `openTopupBalanceModalFromElement`; устранены ошибки линтера JavaScript в HTML-атрибуте `onclick`

2.25.3 – 25.09.2025 12:50
- [Исправление UI] (Модальные окна) Возвращено центрирование: при открытии модалки используется `display: flex` вместо `block`, чтобы сработали `align-items:center; justify-content:center;` в CSS

2.25.4 – 25.09.2025 12:58
- [Единый стиль] (Модальные окна) Унифицированы все модальные окна: `settings.html` (`showModal`), `keys.html` (hostRefresh, ошибки синхронизации, результат удаления) переводят модалки в `display:flex` при открытии

2.25.2 – 25.09.2025 12:38
- [Исправление UI] (Статика) Добавлен placeholder `static/css/tw.css` для предотвращения 404 до первой успешной сборки Tailwind

2.25.1 – 25.09.2025 12:32
- [Исправление сборки] (Docker) Заменён `npm ci` на `npm install` в Node-этапе, чтобы не требовать lock-файл в репозитории
- [Инструкция] (DevOps) Добавлены рекомендации выполнить `docker login` перед сборкой для устранения 401 Unauthorized при pull базовых образов

2.25.0 – 25.09.2025 12:20
- [Новый функционал] (Frontend) Tailwind CSS — Добавлен Tailwind CSS и пайплайн сборки через Docker multi-stage; подключён `tw.css` в `templates/base.html` для унификации модалок и таблиц
- [Инфраструктура] (Dockerfile) Добавлен Node-этап для сборки CSS; артефакт копируется в итоговый образ Python
- [Документация] (docs) Обновлены `docs/tech-stack.md`, `docs/installation.md`, `docs/README.md`; в начале файлов проставлена дата последней редакции

2.24.37 – 25.09.2025 12:00
- [Исправление UI] (Модалка пользователя) Карточка пользователя приведена к исходному виду: оставлены только 3 вкладки — «Платежи», «Ключи», «Уведомления»
- [Улучшение UX] (Модалка пользователя) Ограничена высота окна, добавлена внутренняя прокрутка содержимого вкладок; таблицы в модалке помещены в скроллируемый контейнер
- [Исправление данных] (Платежи) Заголовки и данные таблицы синхронизированы: теперь 4 колонки — Дата, Тип, Сумма, Описание
- [Единый стиль] (CSS) Усилена визуальная индикация активной вкладки; унифицированы отступы и цвета в модалке
- [Документация] Обновлен `docs/features.md` (раздел про карточку пользователя), проставлена дата последней редакции

2.24.36 – 25.09.2025
- [Критическое исправление] (UI) Кебаб-меню — Удалены некорректные радиокнопки из кебаб-меню в settings.html и keys.html, заменены на стандартные кнопки с JavaScript
- [Исправление ошибки] (HTML) settings.html — Заменены радиокнопки на обычные кнопки в кебаб-меню серверов и тарифов с правильными обработчиками
- [Исправление ошибки] (HTML) keys.html — Заменены радиокнопки на обычные кнопки в кебаб-меню ключей с правильными обработчиками
- [Улучшение UX] (JavaScript) Кебаб-меню — Унифицирован подход к работе кебаб-меню во всех шаблонах: единый JavaScript API для открытия/закрытия

2.24.35 – 25.09.2025
- [Критическое исправление] (HTML) base.html — Добавлено отсутствующее модальное окно пользователя с полной функциональностью карточки пользователя
- [Исправление ошибки] (JavaScript) script.js — Исправлена функция switchTab для корректной работы с вкладками модального окна пользователя
- [Улучшение UI] (CSS) style.css — Добавлены стили для модального окна пользователя: сетка информации, вкладки, таблицы и адаптивность
- [Исправление ошибки] (Frontend) Карточка пользователя — Восстановлена функциональность открытия карточки пользователя по двойному клику и через кебаб-меню

2.24.34 – 25.09.2025
- [Исправление ошибки] (CSS) style.css — Исправлена проблема с позиционированием кебаб-меню в таблице транзакций: добавлены унифицированные стили .actions-cell для всех таблиц
- [Улучшение UI] (CSS) style.css — Унифицированы стили кебаб-меню во всех таблицах: одинаковое позиционирование, центрирование кнопок и единообразное отображение
- [Исправление ошибки] (HTML) transactions.html — Исправлена проблема с закрытием кебаб-меню: добавлено автоматическое закрытие при клике на кнопку "Пополнить баланс"
- [Исправление ошибки] (CSS) style.css — Исправлена логика отображения кебаб-меню: теперь все меню скрыты по умолчанию и показываются только при активации соответствующей radio-кнопки

2.24.33 – 25.09.2025
- [Улучшение UX] (Frontend) Кебаб-меню — Изменена логика открытия кебаб-меню с hover на click для лучшего пользовательского опыта
- [Рефакторинг] (HTML) templates — Обновлена HTML-структура кебаб-меню с добавлением скрытых радио-кнопок для click-функциональности
- [Улучшение UI] (CSS) style.css — Реализовано полностью CSS-only решение для кебаб-меню с автоматическим закрытием при выборе другого меню

2.24.32 – 25.09.2025
- [Исправление ошибки] (CSS) style.css — Исправлена проблема с кебаб-меню, которое обрезалось границами таблицы: изменен overflow с hidden на visible для всех таблиц (.transactions-table, #transactions-tab .transactions-table, .table-container, .tab-content)
- [Улучшение UX] (CSS) style.css — Добавлено позиционирование кебаб-меню в левой колонке таблицы с left: 0 для предотвращения выхода за левый край экрана

2.24.31 – 25.09.2025
- [Улучшение UI] (Frontend) Кебаб-меню — Унифицированы стили всех кебаб-меню в проекте под единый стандарт
- [Улучшение UI] (CSS) style.css — Добавлены унифицированные стили для кебаб-меню с улучшенной адаптивностью
- [Рефакторинг] (HTML) templates — Обновлена HTML структура кебаб-меню во всех шаблонах (settings.html, users.html, transactions.html, keys.html)
- [Рефакторинг] (JavaScript) templates — Обновлен JavaScript код для работы с унифицированными кебаб-меню
- [Очистка кода] (CSS) style.css — Удалены устаревшие стили dropdown-menu, заменены на унифицированные кебаб-меню
- [Исправление ошибки] (JavaScript) script.js — Исправлена работа кебаб-меню: обновлены селекторы классов и добавлена глобальная инициализация
- [Исправление ошибки] (HTML) settings.html — Удалены конфликтующие CSS классы с кнопок кебаб-меню
- [Исправление ошибки] (JavaScript) script.js — Исправлен дабл-клик в таблице пользователей: убрана блокировка всплытия события
- [Исправление ошибки] (HTML) keys.html — Удален локальный JavaScript код кебаб-меню, теперь используется глобальный
- [Новая функция] (HTML) users.html — Добавлена кнопка "Открыть карточку" в кебаб-меню пользователей
- [Рефакторинг] (CSS) style.css — Переделаны кебаб-меню на чистое CSS решение без JavaScript
- [Очистка кода] (JavaScript) script.js — Удален весь JavaScript код для кебаб-меню

2.24.30 – 24.09.2025 23:25
- [Исправление ошибки] (API) Ключи — Добавлен отсутствующий эндпоинт `/api/hosts` для загрузки списка хостов в модальном окне обновления ключей
- [Новая функция] (API) Ключи — Добавлен эндпоинт `/api/refresh-keys-by-host` для обновления ключей по конкретному хосту
- [Исправление ошибки] (Frontend) keys.html — Исправлен URL API запроса с `/refresh-keys-by-host` на `/api/refresh-keys-by-host`

2.24.29 – 24.09.2025 23:15
- [Исправление ошибки] (Зависимости) pyproject.toml — Добавлена отсутствующая библиотека `requests==2.31.0` в зависимости проекта
- [Исправление ошибки] (Импорты) app.py — Перенесён импорт `requests` в начало файла и удалены локальные импорты для устранения предупреждений линтера

2.26.1 – 24.09.2025 23:10
- [Исправление ошибки] (API) Уведомления — Добавлен отсутствующий эндпоинт `/create-notification`, устранён 404 при создании уведомления из панели
- [Документация] (docs/api) — Добавлены страницы `create-notification.md` и `resend-notification.md`, ссылки в `docs/README.md`

2.26.0 – 24.09.2025 22:50
- [Исправление ошибки] (API) Поиск пользователей — Добавлен отсутствующий эндпоинт `/api/search-users`, устранена ошибка «Ошибка поиска» в модалке пополнения
- [Новый функционал] (API) Пополнение баланса — Реализован эндпоинт `/api/topup-balance` с пополнением баланса и логированием транзакции как «Зачисление»

2.25.8 – 24.09.2025 22:15
- [Исправление ошибки] (Кодировка) app.py — Восстановлен файл app.py из git-репозитория для исправления проблем с кодировкой русского текста после работы Codex
- [Исправление ошибки] (Импорты) app.py — Добавлен отсутствующий импорт jsonify из Flask для корректной работы API endpoints
- [Исправление ошибки] (Маршруты) app.py — Добавлен отсутствующий декоратор @flask_app.route для функции api_user_notifications
- [Исправление ошибки] (Функции) app.py — Восстановлена функция revoke_consent_route для отзыва согласия пользователей

2.25.7 – 24.09.2025 21:45
- [Исправление ошибки] (UI) Кебаб-меню — Исправлена структура HTML для кебаб-меню в таблицах транзакций и пользователей, заменен класс `kebab-menu` на `kebab-wrapper` для корректной работы JavaScript обработчиков
- [Исправление ошибки] (CSS) Кебаб-меню — Исправлено позиционирование кебаб-меню, убран `right: 0` для предотвращения западания кнопок за границы меню

2.25.6 – 24.09.2025 21:30
- [Исправление ошибки] (Настройки) Контент — Исправлена проблема с отображением текста "О проекте" в настройках контента, исправлен неправильный маппинг ключей about_content/about_text в веб-интерфейсе
- [Исправление ошибки] (API) Настройки — Исправлены ключи настроек в функции save_bot_settings() и ALL_SETTINGS_KEYS для корректной работы с базой данных

2.25.5 – 24.09.2025 20:45
- [Исправление ошибки] (UI) Кебаб-меню — Исправлена работа кебаб-меню для хостов и тарифов в настройках, исправлены CSS селекторы и JavaScript обработчики событий
- [Исправление ошибки] (CSS) Кебаб-меню — Обновлены стили для правильного отображения выпадающих меню с классом `.kebab-wrapper`

2.25.4 – 24.09.2025 20:30
- [Исправление ошибки] (API) Уведомления — Добавлен недостающий маршрут `/resend-notification/<id>` для повторной отправки уведомлений, исправлена ошибка 404 при нажатии кнопки "Повторно отправить уведомление"
- [Новый функционал] (Database) Уведомления — Добавлена функция `get_notification_by_id()` для получения уведомления по ID из базы данных

2.25.3 – 24.09.2025 20:15
- [Исправление ошибки] (UI) Модальное окно "Обновить ключи по хосту" — Исправлена кодировка в JavaScript, заменены вопросительные знаки на корректный русский текст
- [Улучшение] (UI) Выпадающий список хостов — Убраны URL из отображения, теперь показываются только названия хостов для лучшей читаемости

2.25.2 – 24.09.2025 20:00
- [Исправление ошибки] (API) Уведомления — Исправлена кодировка сообщений об ошибках в endpoint `/create-notification`, теперь alert показывает корректные русские сообщения вместо искаженных символов

2.25.1 – 24.09.2025 17:30
- [Исправление ошибки] (API) Пополнение баланса — Добавлен недостающий эндпоинт `/api/topup-balance` для пополнения баланса пользователей через веб-интерфейс

2.24.29 – 24.09.2025 16:51
- [Исправление ошибки] (API) Поиск пользователей — Восстановлен маршрут /api/search-users, теперь ответы возвращают JSON вместо 404

2.25.0 – 24.09.2025 16:43
- [Новый функционал] (API) Ключи — Добавлены эндпоинты `/api/hosts`, `/refresh-user-keys`, `/refresh-keys-by-host` для выборочного обновления ключей.
- [Документация] (docs) API — Добавлено описание новых эндпоинтов и ссылка в обзоре документации.


2.24.1 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) ссылки — Исправлены абсолютные ссылки на относительные в форме редактирования политики конфиденциальности
- [Доработка] (Веб-интерфейс) стили — Обновлены стили формы редактирования политики конфиденциальности в соответствии с темной темой панели
- [Доработка] (Веб-интерфейс) страницы — Реализованы стили для страниц "Условия использования" и "Политика конфиденциальности" в темной теме
- [Доработка] (Веб-интерфейс) навигация — Добавлены кнопки "Назад" на страницы terms и privacy для удобной навигации
- [Доработка] (Веб-интерфейс) дизайн — Все страницы теперь используют единую цветовую схему и стили панели управления
- [Исправление ошибки] (Веб-интерфейс) textarea — Убран background у textarea в форме редактирования
- [Исправление ошибки] (Веб-интерфейс) страница terms — Восстановлена страница /terms к исходному виду
- [Новый функционал] (Веб-интерфейс) модальные окна — Создано модальное окно для редактирования HTML вместо отдельной страницы браузера
- [Новый функционал] (API) контент — Добавлены API endpoints для получения контента страниц terms и privacy
- [Доработка] (JavaScript) модальные окна — Реализованы функции загрузки контента, сохранения и закрытия модального окна

2.24.0 – 21.12.2025
- [Новый функционал] (Документация) создание структуры — Создан каталог docs с полной технической документацией проекта
- [Новый функционал] (Документация) архитектура — Добавлен файл architecture-rules.md с правилами архитектуры и принципами разработки
- [Новый функционал] (Документация) база данных — Создан database.md с подробным описанием схемы БД, таблиц и API
- [Новый функционал] (Документация) диалоги — Добавлен dialog-api.md с описанием API диалогов и состояний пользователей
- [Новый функционал] (Документация) CQRS — Создан generic-cqrs-typing.md со схемой типизации под паттерн CQRS
- [Новый функционал] (Документация) модули — Добавлен modules.md с обзором всех модулей проекта и их взаимодействия
- [Новый функционал] (Документация) общая информация — Создан project-info.md с описанием проекта, возможностей и технического стека
- [Документационные изменения] (Документация) структура — Все файлы документации содержат оглавления и плейсхолдеры для автоматической подстановки

2.23.3 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) настройки контента — Восстановлена функциональность редактирования "Настройки Контента" во вкладке "Бот" в "Настройках"
- [Доработка] (Веб-интерфейс) модальные окна — Добавлены кнопки редактирования для каждого поля контента с открытием модальных окон
- [Доработка] (JavaScript) модальные окна — Созданы функции openContentModal и saveContent для редактирования контента через модальные окна
- [Доработка] (CSS) стили — Добавлены стили для обертки полей контента (.content-field-wrapper) для корректного отображения кнопок редактирования
- [Исправление ошибки] (Веб-интерфейс) поля контента — Сделаны поля контента только для чтения (readonly) с возможностью редактирования через модальные окна

2.23.2 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) настройки — Исправлена проблема с кнопкой "Создать тариф", которая не открывала форму создания нового тарифа
- [Исправление ошибки] (CSS) модальные окна — Добавлены недостающие стили для .modal-backdrop для корректного отображения модальных окон
- [Доработка] (JavaScript) модальные окна — Исправлена функция openPlanModalData для поддержки создания новых тарифов без planId

2.23.1 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) страница ключей — Исправлена проблема с открытием карточки пользователя при клике на кнопку "глаз" в таблице ключей
- [Доработка] (База данных) ключи — Добавлено поле user_keys_count в запрос получения ключей для корректного отображения количества ключей пользователя в модальном окне

2.23.0 – 21.12.2025
- [Новый функционал] (Веб-интерфейс) настройки контента — Созданы отдельные страницы для контента: "О проекте", "Поддержка", "Условия использования", "Политика конфиденциальности"
- [Новый функционал] (API) контент-страницы — Добавлены API endpoints для получения и сохранения контента страниц (/api/content/<type>)
- [Изменения UI/UX] (Веб-интерфейс) настройки бота — Заменены текстовые поля в разделе "Настройки Контента" на ссылки на отдельные страницы с кнопками "Редактировать"
- [Новый функционал] (Веб-интерфейс) модальные окна — Добавлены модальные окна для редактирования контента страниц прямо из настроек бота
- [Доработка] (База данных) настройки — Добавлены новые поля для хранения контента страниц: about_content, support_content, terms_content, privacy_content
- [Доработка] (Веб-интерфейс) стили — Добавлены стили для ссылок на контент-страницы и модальных окон редактирования

2.22.5 – 21.12.2025
- [Изменения UI/UX] (Веб-интерфейс) вкладка "Бот" — Настроен flex-box для отображения блоков настроек в 2 ряда по 2 колонки (аналогично вкладке "Серверы")
- [Изменения UI/UX] (Веб-интерфейс) адаптивность — Добавлена адаптивность для вкладки "Бот": на мобильных устройствах - 1 колонка
- [Доработка] (CSS) — Добавлены стили для #bot-tab form с flex-wrap и justify-content: center для центрирования элементов
- [Исправление ошибки] (CSS) — Кнопка "Сохранить настройки бота" вынесена отдельно от flex-контейнера и занимает всю ширину

2.22.4 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Исправлена высота контейнера charts-grid на главной странице - убран лишний скролл-бар
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Исправлена высота контейнера main-content на странице пользователей - теперь высота соответствует содержимому
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Оптимизирована высота pagination-panel на страницах платежей, ключей и уведомлений - элементы теперь располагаются в одну линию

2.22.3 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Исправлена проблема с бургерным меню - теперь при повторном нажатии меню корректно сворачивается и разворачивается
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Исправлена ширина бокового меню на мобильных устройствах - теперь занимает всю ширину экрана (100%) вместо фиксированных 280px
- [Доработка] (Веб-интерфейс) мобильная навигация — Добавлен обработчик клика для бургерного меню в sidebar, убран overlay для мобильных устройств

2.22.2 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Убран статичный заголовок "Панель управления" в мобильной версии, теперь заголовок динамически меняется в зависимости от страницы
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Исправлена проблема с боковым меню на мобильных устройствах - убран скролл-бар и ограничена высота меню размером экрана
- [Доработка] (Веб-интерфейс) заголовки страниц — Добавлен блок header_title для всех страниц, позволяющий отображать корректные заголовки в мобильной версии

2.22.1 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Устранена проблема с избыточной полосой прокрутки на мобильных устройствах
- [Оптимизация] (Веб-интерфейс) мобильная версия — Уменьшены отступы и высоты контейнеров для более компактного отображения на мобильных экранах
- [Оптимизация] (Веб-интерфейс) графики — Ограничена максимальная высота графиков на мобильных устройствах для предотвращения избыточной прокрутки
- [Оптимизация] (Веб-интерфейс) статистика — Уменьшены отступы в статистических карточках для более компактного отображения

2.22.0 – 21.12.2025
- [Новый функционал] (Веб-интерфейс) мобильная навигация — Добавлена кнопка бургерного меню в header-panel для открытия боковой панели на мобильных устройствах
- [Изменения UI/UX] (Веб-интерфейс) мобильная версия — На мобильных устройствах боковая панель скрыта по умолчанию, открывается по нажатию кнопки в header
- [Исправление ошибки] (Веб-интерфейс) адаптивность — Исправлено отображение интерфейса на мобильных устройствах, убран отступ для скрытой боковой панели
- [Исправление ошибки] (Веб-интерфейс) JavaScript конфликты — Устранены конфликты между JavaScript и CSS, убрано принудительное отображение sidebar на мобильных устройствах
- [Исправление ошибки] (Веб-интерфейс) кэширование — Добавлено принудительное обновление кэша CSS файлов для корректного отображения изменений
- [Оптимизация] (Веб-интерфейс) CSS — Упрощены медиа-запросы для мобильных устройств, объединены дублирующиеся медиа-запросы, добавлены CSS правила для мобильной навигации

2.21.0 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) кнопка бургерного меню — Удалена ненужная кнопка бургерного меню из header, теперь используется только кнопка в боковом меню
- [Исправление ошибки] (Веб-интерфейс) структура HTML — Исправлена структура HTML бокового меню, убран лишний закрывающий div
- [Исправление ошибки] (Веб-интерфейс) дублирование элементов — Устранено дублирование кнопок выхода и информации о версии в боковом меню
- [Исправление ошибки] (Веб-интерфейс) мобильная версия — Исправлено отображение бокового меню в мобильной версии, теперь sidebar-collapsed корректно отображается
- [Исправление ошибки] (Веб-интерфейс) кнопка бургера — Исправлено отображение кнопки бургера в menu-items-header на мобильных устройствах
- [Исправление ошибки] (Веб-интерфейс) элементы навигации — Исправлено отображение sidebar-nav-main и sidebar-nav-controls в мобильной версии
- [Изменения UI/UX] (Веб-интерфейс) мобильная версия — На мобильных устройствах боковая панель по умолчанию отображается в свернутом режиме (60px) с иконками
- [Изменения UI/UX] (Веб-интерфейс) переключение меню — При нажатии на кнопку бургерного меню в мобильной версии панель разворачивается на полную ширину (280px)
- [Доработка] (Веб-интерфейс) JavaScript — Обновлена логика управления боковым меню для правильной работы без удаленной кнопки
- [Доработка] (Веб-интерфейс) CSS — Обновлены стили для правильного отображения свернутого меню на мобильных устройствах
- [Оптимизация] (Веб-интерфейс) код — Удалены неиспользуемые CSS стили для кнопки бургерного меню

2.20.0 – 21.12.2025
- [Исправление ошибки] (Веб-интерфейс) сохранение состояния меню — Добавлено сохранение состояния бокового меню в localStorage, теперь состояние не сбрасывается при обновлении страницы
- [Исправление ошибки] (Веб-интерфейс) выравнивание кнопок управления — Исправлено выравнивание кнопок управления внизу свернутого бокового меню, теперь они правильно прижимаются к низу
- [Изменения UI/UX] (Веб-интерфейс) мобильная версия — В мобильной версии меню по умолчанию свернуто и отображается кнопка бургерного меню
- [Изменения UI/UX] (Веб-интерфейс) header кнопка — Кнопка в header выровнена по центру панели
- [Доработка] (Веб-интерфейс) JavaScript — Обновлена логика управления состоянием меню с поддержкой localStorage и правильной работой на мобильных устройствах
- [Доработка] (Веб-интерфейс) CSS — Обновлены стили для правильного выравнивания элементов в свернутом меню и мобильной версии

2.19.0 – 21.12.2025
- [Новый функционал] (Веб-интерфейс) сворачивание бокового меню — Добавлена возможность сворачивания бокового меню в режим только с иконками
- [Новый функционал] (Веб-интерфейс) иконки навигации — В свернутом режиме отображаются только иконки: 🏠 Главная, 👥 Пользователи, 💳 Платежи, 🔑 Ключи, 🔔 Уведомления, 📙 Инструкции, ⚙️ Настройки
- [Новый функционал] (Веб-интерфейс) переключатели в свернутом режиме — Добавлены toggle-slider для скрытого режима, бота витрины и бота поддержки в свернутом меню
- [Новый функционал] (Веб-интерфейс) иконка версии — Добавлена иконка FontAwesome6 server для отображения версии в свернутом режиме
- [Новый функционал] (Веб-интерфейс) иконка выхода — Добавлена иконка FontAwesome6 fas fa-sign-out-alt для кнопки выхода в свернутом режиме
- [Изменения UI/UX] (Веб-интерфейс) бургерное меню — Теперь бургерное меню переключает между тремя состояниями: развернутое, свернутое (иконки), скрытое
- [Изменения UI/UX] (Веб-интерфейс) адаптивность — Свернутое меню имеет ширину 60px и автоматически адаптирует main-content и header-panel
- [Доработка] (Веб-интерфейс) JavaScript — Обновлена логика управления боковым меню для поддержки трех состояний
- [Доработка] (Веб-интерфейс) синхронизация — Переключатели ботов и скрытого режима синхронизируются между развернутым и свернутым режимами
- [Доработка] (Веб-интерфейс) tooltips — Добавлены подсказки для всех элементов навигации в свернутом режиме

2.18.0 – 21.12.2025
- [Новый функционал] (Веб-интерфейс) закрепленная панель — Добавлена закрепленная панель в head размером 55px для размещения будущих элементов управления
- [Новый функционал] (Веб-интерфейс) header бокового меню — Добавлен header в боковом меню с бургером для скрытия панели и логотипом
- [Изменения UI/UX] (Веб-интерфейс) навигация — Бургер в боковом меню позволяет скрывать/показывать панель на десктопе
- [Изменения UI/UX] (Веб-интерфейс) адаптивность — Обновлена мобильная версия с учетом новой структуры header-panel
- [Доработка] (Веб-интерфейс) JavaScript — Добавлена логика управления скрытием бокового меню через бургер в header
- [Доработка] (Веб-интерфейс) страница логина — Добавлена header-panel на страницу логина для единообразия

2.17.0 – 21.12.2025
- [Новый функционал] (Бот) видеоинструкции — Добавлена поддержка видеоинструкций для всех платформ (Android, iOS, Windows, macOS, Linux)
- [Новый функционал] (Бот) админские команды — Добавлены команды /upload_video, /list_videos, /delete_video для управления видеоинструкциями
- [Доработка] (Бот) инструкции — Теперь при выборе платформы пользователи получают видеоинструкцию вместе с текстовой инструкцией
- [Доработка] (Конфигурация) — Добавлены настройки VIDEO_INSTRUCTIONS_ENABLED и VIDEO_INSTRUCTIONS_DIR для управления видеоинструкциями
- [Доработка] (Бот) меню QR-кода — Добавлен текст "Отсканируйте QR-код через VPN приложение" при показе QR-кода ключа
- [Доработка] (Бот) меню QR-кода — Добавлены кнопки под QR-кодом: "📑 Скопировать ключ", "❓ Инструкция как пользоваться", "⬅️ Назад к списку ключей"
- [Изменения UI/UX] (Веб-интерфейс) стили кнопок — Добавлен темный фон #282b30 для .button-small и кнопок в .settings-container
- [Изменения UI/UX] (Веб-интерфейс) стили кнопок — Установлен зеленый фон #008771 для .button-primary в .settings-container
- [Изменения UI/UX] (Веб-интерфейс) кнопки создания — Изменен цвет кнопок "Создать тариф" и "Добавить сервер" на зеленый #008771

2.16.7 – 21.12.2025
- [Доработка] (Бот) меню QR-кода — Добавлен текст "Отсканируйте QR-код через VPN приложение" при показе QR-кода ключа
- [Доработка] (Бот) меню QR-кода — Добавлены кнопки под QR-кодом: "📑 Скопировать ключ", "❓ Инструкция как пользоваться", "⬅️ Назад к списку ключей"
- [Изменения UI/UX] (Веб-интерфейс) стили кнопок — Добавлен темный фон #282b30 для .button-small и кнопок в .settings-container
- [Изменения UI/UX] (Веб-интерфейс) стили кнопок — Установлен зеленый фон #008771 для .button-primary в .settings-container
- [Изменения UI/UX] (Веб-интерфейс) кнопки создания — Изменен цвет кнопок "Создать тариф" и "Добавить сервер" на зеленый #008771

2.16.6 – 20.12.2025
- [Новый функционал] (Бот) — Добавлена кнопка "🗐 Скопировать ключ" для удобного копирования VLESS ключей в отдельном сообщении
- [Изменения UI/UX] (Бот) — Улучшена компоновка кнопок в меню ключа: "Продлить", "Скопировать ключ" и "Показать QR-код" в отдельных строках
- [Исправление ошибки] (Бот) — Исправлено отображение VLESS ключей: убрана обертка <pre> которая растягивала ключ на всю ширину, оставлен только <code> для моноширинного шрифта
- [Изменения UI/UX] (Бот) — Добавлен заголовок "НИЖЕ ВАШ КЛЮЧ" перед отображением ключа для лучшей навигации пользователя
- [Изменения UI/UX] (Бот) — Инструкции для пользователя теперь отображаются как цитата (blockquote) для лучшего визуального выделения

2.16.5 – 20.12.2025
- [Изменения UI/UX] (Веб-интерфейс) — Унифицированы стили вкладок на всех страницах: теперь все используют единый стиль как на странице настроек
- [Изменения UI/UX] (Веб-интерфейс) — Заменены эмодзи на Font Awesome иконки в навигации страницы инструкций для единообразия
- [Рефакторинг] (Шаблоны) — Обновлены комментарии в шаблонах instructions.html и versions.html для соответствия стандарту

2.16.4 – 20.12.2025
- [Исправление ошибки] (JavaScript) — Исправлены тексты статусов в JavaScript коде: все переключатели теперь показывают "ON/OFF" вместо "Включен/Отключен/Запущен/Остановлен"
- [Исправление ошибки] (Шаблоны) — Обновлены тексты статусов в debug.html и debug_settings.html на "ON/OFF"

2.16.3 – 20.12.2025
- [Изменения UI/UX] (Веб-интерфейс) — Изменен текст "Скрытый ПД:" на "Скрытый режим" в сайдбаре
- [Изменения UI/UX] (Веб-интерфейс) — Изменены статусы ботов с "Включен/Отключен/Запущен/Остановлен" на "ON/OFF" для единообразия
- [Рефакторинг] (Веб-интерфейс) — Унифицированы стили вкладок: все страницы теперь используют единый селектор tab-navigation
- [Рефакторинг] (Веб-интерфейс) — Удалены дублирующие локальные стили навигации из шаблонов instructions.html и settings.html
- [Новый функционал] (Веб-интерфейс) — Добавлены tooltips для всех вкладок навигации на странице инструкций
- [Рефакторинг] (CSS) — Добавлены стили для кнопок в tab-navigation для поддержки как ссылок, так и кнопок

2.16.2 – 20.12.2025
- [Исправление ошибки] (Веб-интерфейс) — Исправлена ширина bot-label: добавлен min-width: 110px для лучшего выравнивания
- [Исправление ошибки] (Веб-интерфейс) — Исправлено выравнивание bot-status-text: изменено с justify-self: end на justify-self: center
- [Исправление ошибки] (Веб-интерфейс) — Исправлены названия переключателей ботов: заменены ON/OFF на правильные "Включен/Отключен" и "Запущен/Остановлен"
- [Изменения UI/UX] (Веб-интерфейс) — Переименован settings-navigation в tab-navigation для унификации стилей навигации по вкладкам
- [Рефакторинг] (Веб-интерфейс) — Разделена страница DevPage на отдельные страницы: /versions, /demo, /debug с общей навигацией
- [Новый функционал] (Веб-интерфейс) — Созданы отдельные маршруты и шаблоны для страниц версий, демо и отладки
- [Исправление ошибки] (Веб-интерфейс) — Исправлены стили навигации вкладок: добавлены !important и специфичные селекторы для корректного отображения кнопок навигации

2.16.1 – 20.12.2025
- [Изменения UI/UX] (Веб-интерфейс) — Обновлены названия элементов управления ботами: "Режим" → "Скрытый ПД", "Shop" → "Бот витрина", "Support" → "Бот поддержка"
- [Исправление ошибки] (Веб-интерфейс) — Исправлено выравнивание toggle переключателей в bot-controls с улучшенным CSS
- [Изменения UI/UX] (Веб-интерфейс) — Изменены надписи статусов: "Включен/Отключен/Запущен/Остановлен" → "ON/OFF"
- [Новый функционал] (Веб-интерфейс) — Создана новая страница DevPage (/dev) с вкладками: История изменений, Демо страница, Отладка
- [Рефакторинг] (Веб-интерфейс) — Перенесена функциональность versions на DevPage для лучшей организации разработки
- [Исправление ошибки] (DevPage) — Исправлены неправильные названия роутов в DevPage (start_bot_route → start_shop_bot_route)
- [Изменения UI/UX] (Веб-интерфейс) — Улучшено выравнивание элементов bot-controls с использованием CSS Grid: bot-label (слева), bot-toggle (центр), bot-status-text (справа)

2.16.0 – 20.09.2025
- [Новый функционал] (Веб-интерфейс) — Полная унификация системы кнопок с внедрением Font Awesome иконок и системы размеров (xs, sm, md, lg, xl, xxl)
- [Изменения UI/UX] (Веб-интерфейс) — Добавлена демонстрационная страница с примерами всех элементов интерфейса: формы, таблицы, модальные окна, навигация, алерты
- [Рефакторинг] (Веб-интерфейс) — Исправлена цветовая схема кнопок: унифицированы цвета danger, success, warning с правильными hover-эффектами
- [Изменения UI/UX] (Веб-интерфейс) — Добавлены tooltips ко всем кнопкам и интерактивным элементам с описанием их назначения
- [Новый функционал] (Веб-интерфейс) — Создана система вкладок на странице версий: История изменений, Демо страница, Отладка
- [Доработка] (Веб-интерфейс) — Обновлены все кнопки в проекте: добавлены иконки, размеры и унифицированные стили

2.15.7 – 20.09.2025
- [Изменения UI/UX] (Веб-интерфейс) — Разделена панель пагинации на две области равной ширины: слева кнопки действий, справа пагинация и переключатель записей
- [Исправление ошибки] (Пагинация) — Исправлена логика пагинации: теперь всегда отображается максимум 6 номеров страниц с правильным алгоритмом сокращения
- [Изменения UI/UX] (Веб-интерфейс) — Добавлены подсказки (tooltips) ко всем элементам пагинации и кнопкам действий
- [Доработка] (Адаптивность) — Улучшена мобильная адаптивность панели пагинации с вертикальным расположением элементов

2.15.6 – 20.09.2025
- [Изменения UI/UX] (Веб-интерфейс) — Изменен порядок столбцов в таблице платежей: ID, Пользователь, Дата, Тип операции, Способ оплаты, Цена, Статус, Хост, План, Транзакция, Ключ
- [Изменения UI/UX] (Веб-интерфейс) — Объединены колонки "Цена" и "Звезды": информация о звездах теперь отображается под ценой в рублях на отдельной строке
- [Исправление ошибки] (JavaScript) — Исправлена функция скрытого режима для корректного отображения звезд в объединенной колонке цены

2.15.5 – 21.12.2025
- [Изменения UI/UX] (Веб-интерфейс) — Удалены заголовки h1 со всех страниц панели управления для более чистого дизайна

2.15.4 – 20.12.2025
- [Исправление ошибки] (UI/UX) — Исправлена проблема с прокруткой таблицы ключей: добавлен отступ снизу для видимости последнего объекта
- [Изменения UI/UX] (Кнопки) — Обновлены цвета фона для modal-action-btn и copy-btn на #00877140
- [Изменения UI/UX] (Статусы) — Обновлены стили для статусов: status-paid, status-active и status-pending с новыми цветами и рамками

2.15.3 – 20.09.2025
- [Исправление ошибки] (Docker) — Настроена кодировка UTF-8 для корректного отображения логов с эмодзи флагов стран
- [Новый функционал] (Веб-интерфейс) — Добавлено модальное окно для отображения ошибок синхронизации ключей с 3x-ui панелями
- [Доработка] (API) — Обновлена логика синхронизации ключей для сбора информации об ошибках
- [Улучшение UX] (Ключи) — При нажатии "Обновить" теперь показываются ключи, которые не найдены в 3x-ui панелях
- [Исправление ошибки] (UX) — Исправлена логика обновления страницы: теперь страница обновляется только после закрытия модального окна с ошибками
- [Улучшение UX] (Модальные окна) — Добавлена возможность закрытия модального окна кликом вне его области
- [Исправление ошибки] (API) — Исправлено отображение email из 3x-ui API вместо N/A в модальном окне ошибок
- [Улучшение UI] (Модальные окна) — Обновлены стили модального окна ошибок синхронизации под темную тему с правильными цветами
- [Исправление ошибки] (API) — Исправлено получение email из поля key_email вместо email в модальном окне ошибок
- [Улучшение UI] (Модальные окна) — Изменен цвет фона на #151f31 и убрана кнопка "Закрыть и обновить"
- [Улучшение UX] (Форматирование) — Изменен формат дат на ГГГГ-ММ-ДД H24:mi в модальном окне ошибок
- [Новый функционал] (API) — Добавлен эндпоинт /delete-error-keys для удаления ключей с ошибками из 3x-ui панелей
- [Новый функционал] (Веб-интерфейс) — Добавлена кнопка "Удалить ключи с ошибками в 3x-ui" в модальное окно ошибок синхронизации
- [Улучшение UX] (Модальные окна) — После удаления ключей отображается результат операции без закрытия модального окна
- [Исправление ошибки] (UI) — Исправлены стили кнопки удаления: используется класс button button-danger вместо несуществующего btn btn-danger
- [Улучшение UX] (Модальные окна) — Результат удаления ключей теперь отображается в отдельном модальном окне с прокруткой для длинного текста
- [Исправление ошибки] (API) — Исправлена логика удаления ключей из 3x-ui: теперь ищет клиентов как в базе данных, так и в самой панели по email
- [Исправление ошибки] (API) — Добавлена передача xui_client_uuid в данные об ошибках синхронизации для корректного удаления ключей
- [Исправление ошибки] (API) — Улучшена функция delete_client_on_host: теперь принимает UUID и пытается удалить по нему напрямую
- [Новый функционал] (API) — Добавлена функция delete_client_by_uuid для прямого удаления клиентов по UUID без поиска хостов
- [Исправление ошибки] (API) — Исправлена проблема с поиском хостов: теперь удаление происходит по всем доступным хостам
- [Исправление ошибки] (Планировщик) — Исправлена логика уведомлений об истечении ключей: теперь уведомления не отправляются после истечения срока действия
- [Доработка] (Планировщик) — Добавлены дополнительные проверки времени в функциях отправки уведомлений для предотвращения некорректных сообщений
- [Исправление ошибки] (Планировщик) — Устранена проблема отправки уведомлений "за 1 час" уже после истечения ключа

2.15.2 – 20.09.2025
- [Исправление ошибки] (Код) — Устранен дублирующий импорт aiohttp в файле handlers.py
- [Исправление ошибки] (Код) — Исправлена незавершенная строка logger.info в bot_controller.py
- [Очистка] (Файлы) — Удалены дублирующие файлы clientStats_1.json, inbound_1.json, inbounds.json (содержали только "404 page not found")
- [Анализ] (Проект) — Проведен полный анализ проекта на предмет дублирующих файлов и ошибок

2.15.1 – 20.09.2025
- [Документационные изменения] (ROADMAP) — Полностью переписан план развития проекта с учетом реализованного функционала
- [Документационные изменения] (ROADMAP) — Отмечены все реализованные функции из предыдущих версий
- [Документационные изменения] (ROADMAP) — Убраны временные рамки, добавлены приоритеты разработки
- [Рефакторинг] (Документация) — ROADMAP теперь отражает реальное состояние проекта

2.15.0 – 20.09.2025
- [Новый функционал] (Проект) — Проект полностью переработан и передан в собственность ukarshiev
- [Рефакторинг] (Git) — Настроена полная независимость от оригинального репозитория
- [Документационные изменения] (README) — Обновлена документация под новый репозиторий
- [Оптимизация] (Проект) — Проект готов к дальнейшему развитию как полностью независимый

2.14.5 – 20.09.2025
- [Исправление ошибки] (Веб-интерфейс) — Исправлена ошибка "Ошибка загрузки" в карточке пользователя на вкладке "Уведомления"
- [Доработка] (API) — Добавлен недостающий эндпоинт /api/user-notifications/<user_id> для получения уведомлений пользователя
- [Доработка] (Веб-интерфейс) — Добавлены тултипы к заголовкам таблицы уведомлений в карточке пользователя

2.14.4 – 20.09.2025
- [Доработка] (Веб-интерфейс) — Добавлена статистика уведомлений на дашборде
- [Доработка] (Веб-интерфейс) — Добавлена карточка "Всего уведомлений" в разделе статистики
- [Доработка] (Веб-интерфейс) — Добавлен график "Новые уведомления" в аналитике за 30 дней
- [Доработка] (База данных) — Создана функция get_total_notifications_count() для подсчета общего количества уведомлений
- [Доработка] (База данных) — Обновлена функция get_daily_stats_for_charts() для включения статистики уведомлений по дням


2.14.3 – 20.09.2025
- Кнопка «Выйти»: центрирована, ширина 100% (до 200px)
- Настройки: из форм редактирования хоста и тарифа убраны кнопки «Удалить» (только в меню ⋮)
- Подсказки: добавлен tooltip «Выйти из панели» на кнопку выхода

2.14.2 – 20.09.2025
- 3x‑ui: исправлена передача лимита трафика из тарифа (ГБ → байты)
- Покупка ключа: квота теперь устанавливается корректно вместо «∞»
- Дополнительно: дублируем обновление лимита через нативный endpoint панели

2.14.1 – 20.09.2025
- Бот: исправлена оплата "⭐ Telegram Звезды (Stars)" при покупке тарифа (создание счёта и обработка)
- Бот: добавлена фиксация pending-транзакции для Stars и корректная валидация pre-checkout
- Бот: бесплатные тарифы обрабатываются без выставления счёта

2.14.0 – 20.09.2025
- Панель: добавлен раздел «Уведомления» с таблицей, поиском и повторной отправкой
- Настройки: обновлён «Серверы» — таблица тарифов, модалки и меню «⋮»
- Интерфейс: улучшены переключатели ботов, скрытый режим и мобильное меню

2.13.3 – 20.09.2025
- Настройки: основной контент вкладки «Серверы» центрирован через глобальный CSS
- Стили: правило `#servers-tab > section.settings-section` с max-width и auto-маржинами
- Версия проекта повышена до 2.13.3

2.13.2 – 19.09.2025
- Настройки: контент вкладки «Серверы» центрирован, max-width 1000px, адаптивно
- Тарифы: список заменён на таблицу; двойной клик открывает модалку редактирования
- Модалки: кнопки «🗑️ Удалить», «Отмена», «Сохранить»; удаление перенесено в модалки
- Хосты: удаление из шапки карточки убрано; удаление доступно в форме редактирования
- Стили: добавлены таблица тарифов и серые кнопки, улучшена адаптивность
- Версия проекта повышена до 2.13.2

2.13.3 – 19.09.2025
- Уведомления: в тексте автопродления подставляется сумма тарифа (RUB)
- Версия проекта повышена до 2.13.3

2.13.1 – 19.09.2025
- Панель: исправлена структура модалки пользователя — footer внутри modal-content
- Уведомления: модалка создания — footer корректно вложен
- Версия проекта повышена до 2.13.1

2.13.0 – 19.09.2025
- Планировщик: добавлено автопродление с баланса при достаточных средствах
- Уведомления: подавление стандартных 72/48/24/1 при достаточном балансе
- Уведомления: новый тип за 24 часа — уведомление про автопродление без кнопок
- Транзакции: логирование автосписаний; статистика покупок обновляется автоматически
- Версия проекта повышена до 2.13.0

2.12.4 – 19.09.2025
- Уведомления: изменён текст (дата, баланс), кнопки («🔄 Продлить ключ», «💰 Пополнить баланс»)
- Уведомления: «Создать» слева, «Обновить» справа; модалка — «Отменить» слева, «Запустить» справа
- Ручное создание/повтор уведомлений отправляет обновлённый текст и кнопки
- Версия проекта повышена до 2.12.4

2.12.3 – 19.09.2025
- Уведомления: добавлена кнопка «Создать» и модалка создания уведомления
- Панель: поиск пользователей в модалке, запуск уведомлений по маркеру (72/48/24/1)
- Уведомления: «Повтор» теперь отправляет вместе с inline‑кнопками
- Версия проекта повышена до 2.12.3

2.12.2 – 19.09.2025
- Уведомления: текст дополнен номером ключа и сервером
- Уведомления: кнопка продления переименована на «🔄 Продлить ключ» и ведёт к конкретному ключу
- Версия проекта повышена до 2.12.2

2.12.1 – 19.09.2025
- Панель: раздел «Журнал уведомлений» переименован в «Уведомления»
- Уведомления: добавлена кнопка 🔍 (карточка пользователя) и колонка «Действия» с повторной отправкой 🔄
- Пользователи: добавлена колонка «Уведомления» (количество)
- Карточка пользователя: добавлена вкладка «Уведомления» с таблицей

2.12.0 – 19.09.2025
- Панель: добавлен раздел «Журнал уведомлений» с пагинацией
- Планировщик: логирование отправленных уведомлений (ID пользователя, время, текст)
 - Планировщик: устойчивые уведомления — учет отправленных маркеров (72/48/24/1) в БД и catch-up на старте/в ходе работы, чтобы не пропускать уведомления

2.11.1 – 19.09.2025
- Бот: «🔄 Продлить текущий [N]» перемещён в самый верх списка серверов при «🛒 Купить VPN»
- Бот: возвращён прямой показ списка серверов без промежуточного меню

2.11.0 – 19.09.2025
- Бот: в разделе «🛒 Купить VPN» добавлен пункт «🔄 Продлить текущий [N]», ведущий в «Мои ключи»
- Бот: пункт «Продлить текущий» отображается только если у пользователя есть хотя бы один ключ

2.10.2 – 19.09.2025
- Планировщик: исправлена проверка статуса бота (уведомления об истечении снова работают)

2.10.1 – 19.09.2025
- Бот: при оплате «С баланса» показывается сообщение «✅ С баланса списано N.NN RUB»
- Бот: после оплаты с баланса больше не предлагаются альтернативные способы оплаты
- Бот: в кнопке «💰 С баланса» теперь отображается текущий баланс пользователя
- Бот: единый текст для howto_vless берётся из конфига

2.10.0 – 19.09.2025
- Бот: добавлен способ оплаты «💰 С баланса» и поставлен первым
- Бот: тексты обновлены (подсказка суммы пополнения, «Баланс» → «💰 Баланс»)
- Бот: главное меню с иконками (🛒 Купить VPN, 💰Пополнить баланс, ⁉️ Помощь и поддержка)
- Бот: «❓ Как использовать» переименовано в «❓ Инструкция как  пользоваться»; «📖 Инструкция» ведет туда

2.9.7 – 19.09.2025
- TON Connect: добавлена 1.5 c задержка перед отключением соединения для стабильного завершения
- Версия повышена

2.9.6 – 19.09.2025
- TON Connect: добавлен безопасный ретрай при ошибках моста (SSE/TransferEncodingError)
- TON Connect: уведомление пользователю при двух неудачных попытках отправки транзакции
- Обновлены зависимости версий в проекте

2.9.5 – 19.09.2025
- Бот: в профиль добавлен вывод Баланса сразу после строки Профиль
- Бот: в меню профиля добавлена кнопка «Пополнить баланс»
- Бот: тексты обновлены — Stars → «Telegram Звезды (Stars)», TON → «TonCoin (криптовалюта)», подсказка суммы
- Бот: исправлен текст на «Выберите операционную систему устройства для получения инструкции по настройке:»
- Панель: добавлена колонка Баланс в таблице «Пользователи» и поле Баланс в модалке
- Панель: добавлен API /api/user-balance/<id> и загрузка баланса в JS

2.9.4 – 19.09.2025
- TON Connect: добавлено корректное отключение и перехват SSE ошибок (TransferEncodingError)
- Логи: уменьшен шум по orphan-клиентам; краткая сводка и опциональное автоудаление
- Настройки: добавлен флаг auto_delete_orphans (по умолчанию false)

2.9.3 – 19.09.2025
- Бэкенд: автозапуск ботов Shop/Support при старте сервера
- Панель: убрано авто-включение тумблеров; теперь только отображается состояние
- Логи: боты запускаются без входа на страницу панели

2.9.2 – 19.09.2025
- Бот: скрыты сервера без тарифов из меню выбора сервера (покупка/триал)

2.9.3 – 19.09.2025
- Бот: скрытие кнопки «Поддержка» при выключенном флаге support_enabled
- Бот: текст инструкций изменен на «Выберите вашу опреационную систему...»
- Панель: добавлена настройка minimum_topup; проверки и тексты пополнения берут значение из панели

2.9.2 – 19.09.2025
- Бот: переработано главное меню согласно ТЗ (Купить VPN, Мой профиль, Пополнить баланс, Помощь и поддержка, О проекте)
- Бот: «Мой профиль» теперь содержит пункты «Мои ключи» и «Реферальная программа»
- Бот: добавлен раздел «Помощь и поддержка» с пунктами «Поддержка» и «Как использовать»
- Бот: реализован сценарий «Пополнить баланс» (179/300/500/другая сумма)
- Платежи: пополнение баланса через Telegram Stars и TON Connect, фиксация «Пополнение» в админке
- БД: добавлено поле balance у пользователя; функции чтения и пополнения

2.8.9 – 19.09.2025
- Бот: убран пункт «🏠 Главное меню» из Reply-клавиатуры
- Бот: «🤝 Реферальная программа» скрывается, если выключена в панели
- Бот: Reply-клавиатура теперь формируется динамически из настроек

2.8.8 – 19.09.2025
- Панель: убрана кнопка «Назад» на странице «Инструкции»
- Бот: тексты инструкций теперь читаются из файлов панели (instructions/*.md)

2.8.7 – 19.09.2025
- Бот: добавлен пункт «🖥 MacOS» в инструкциях; группировка меню 2-3-1
- Панель: добавлен раздел «📙 Инструкции» с 5 вкладками и редактированием
- Сайдбар: новый пункт «Инструкции» перед «Настройки»

2.8.6 – 19.09.2025
- Бот: вынесено главное меню в постоянную Reply Keyboard внизу
- Добавлены текстовые хэндлеры для пунктов Reply Keyboard
- Старт/онбординг теперь всегда присылают Reply Keyboard

2.8.5 – 19.09.2025
- Панель: авто-включение тумблеров Режим/Shop/Support при загрузке страницы

2.8.4 – 19.09.2025
- Сайдбар: снята блокировка тумблера Shop — теперь все 3 переключателя можно включать

2.8.3 – 19.09.2025
- Настройки: исправлены кнопки Добавить/Редактировать хост и тариф (корректные onclick, безопасная передача параметров)
- Настройки: checkHost теперь корректно получает имя хоста и изменяет состояние кнопки
- Навигация вкладок: функция showTab больше не зависит от глобального event; передается this

2.8.2 – 13.09.2025
- Трафик 3x‑ui: лимит теперь выставляется при покупке через нативный updateClient; проверено (пример: 30 ГБ)
- Ключи: колонка «Общ / Исп / Ост» заполняется сразу после покупки; вывод в 3 строки; «∞» для безлимита
- Ключи: мгновенное сохранение «Квоты» и «Осталось» в БД; улучшена синхронизация с панелью
- Ключи: подсветка «Осталось» по порогам (0д0ч – красный; ≤1д24ч – оранжевый; ≤3д24ч – жёлтый; иначе – зелёный)
- Dashboard: добавлен график «Заработано (RUB)»; карточка переименована в «Всего заработано»
- Тарифы: добавлены поля «Дни» и «Трафик (ГБ)», плейсхолдеры и редактирование тарифов; старые записи не затронуты
- 3x‑ui: запись лимита трафика в байтах; улучшены логи и верификация total/down
- Уведомление администратору: исправлен парсинг (перевод на HTML вместо Markdown)

2.8.1 – 12.09.2025
- Страница «Версии»: тёмная тема textarea и высота на весь экран
- Версионирование CSS в ссылке, чтобы форсировать обновление стилей
- Небольшие правки обработчика версий для стабильности

2.8.0 – 12.09.2025
- Переименован проект в dark-maximus
- Убраны упоминания прежнего автора
- Docker-окружение для локального запуска на `localhost:1488`
- Dashboard: заголовок изменен на `dark-maximus.com`
- Добавлен скрытый режим: тумблер в сайдбаре, маскирование ID/username/email/сумм в таблицах и части настроек
- Исправлен визуальный баг тумблера «Режим» (без состояния «Запущен/Остановлен»)
- Добавлена страница «Версии» с возможностью редактировать CHANGELOG.md в панели
- Ключи: корректное отображение триал-ключей; колонка «Тип» (vless); колонка «Триал» (чекбокс); «Дата начало» и «Дата окончания»; «Осталось»
- Кнопка «Обновить» в «Ключи» синхронизирует даты и статус с 3x-ui (`inbounds/list`)
- 3x-ui: в email записывается Telegram ID; в комментарий — `user<ID>-key<N>@<host>.bot`
- Кнопки лупы рядом с ID в «Пользователи», «Платежи», «Ключи» для открытия модалки
- В «Платежи» и «Ключи» всегда показывается username из таблицы `users`

2.7.0 – 11.09.2025
- Добавлена базовая страница «Версии» и переход по блоку версии
- Скрытый режим: первичная реализация и маскирование основных полей
- Улучшено: визуальное состояние тумблера скрытого режима
- Подготовка к расширениям таблицы «Ключи» и интеграции 3x-ui

## [2.0.0] - 2025-12-19

### 🚀 Новые возможности
- **Аналитика заработка пользователей**: Добавлена функция отслеживания общей суммы заработанных средств по каждому пользователю
- **Расширенная информация о платежах**: Полная история транзакций с метаданными (хост, план, период, действие)
- **Быстрые действия**: Кнопки для перехода в Telegram профили и копирования данных прямо в таблицах
- **Улучшенная модальная система**: Компактные модальные окна с расширенной информацией в заголовке

### 🎨 Улучшения интерфейса
- **Полноэкранные графики**: Диаграммы теперь занимают всю доступную область для лучшей визуализации
- **Компактные модальные окна**: Уменьшена ширина модальных окон на 30% для более удобного просмотра
- **Оптимизированная пагинация**: Уменьшена высота панелей пагинации и улучшено расположение элементов
- **Центрированные заголовки**: Улучшена типографика и выравнивание текста на всех страницах
- **Современный дизайн**: Обновлен общий стиль интерфейса для лучшего пользовательского опыта

### 🔧 Технические улучшения
- **Исправлены JOIN'ы**: Корректное отображение данных пользователей в модальных окнах
- **Оптимизированные SQL запросы**: Улучшена производительность базы данных
- **Улучшенная обработка ошибок**: Более стабильная работа системы
- **Кэширование данных**: Быстрая загрузка информации о пользователях

### 📊 Улучшения аналитики
- **Статистика заработка**: Отслеживание общей суммы заработанных средств по каждому пользователю
- **Детальные транзакции**: Полная информация о платежах с метаданными
- **Улучшенные фильтры**: Более гибкая настройка отображения данных
- **Расширенная отчетность**: Дополнительные метрики для анализа бизнеса

### 🐛 Исправления ошибок
- **Исправлено отображение платежей**: Теперь корректно показываются все транзакции пользователей
- **Исправлено отображение ключей**: Ключи пользователей теперь корректно отображаются в модальных окнах
- **Исправлен расчет заработка**: Корректный подсчет заработанных средств по статусу 'paid'
- **Исправлены ссылки Telegram**: Кнопки "Перейти в Telegram" теперь ведут на правильные профили

### 📱 Улучшения мобильной версии
- **Адаптивный дизайн**: Улучшена работа на мобильных устройствах
- **Оптимизированная навигация**: Упрощена навигация на маленьких экранах
- **Улучшенные кнопки**: Более удобные кнопки для мобильных устройств

### 🔄 Изменения в структуре
- **Переработана структура модальных окон**: Убрана вкладка "Основная информация", информация перенесена в заголовок
- **Улучшена навигация**: Автоматическое переключение на вкладку "Платежи" при открытии профиля пользователя
- **Оптимизированы таблицы**: Добавлены быстрые действия прямо в таблицы пользователей

### 📈 Производительность
- **Оптимизированы запросы к БД**: Улучшена скорость загрузки данных
- **Кэширование**: Добавлено кэширование часто используемых данных
- **Асинхронная загрузка**: Улучшена загрузка данных без блокировки интерфейса

---

## [1.0.0] - 2025-12-01

### 🎉 Первоначальный релиз
- Базовая функциональность Telegram бота для продажи VPN
- Интеграция с панелью управления 3x-ui
- Веб-панель управления
- Поддержка платежных систем (YooKassa, CryptoBot, Heleket)
- Система управления пользователями
- Автоматическая выдача ключей после оплаты
- Поддержка мульти-серверной архитектуры
- Система тарифных планов
- Принудительная подписка на каналы
- Тестовый период для новых пользователей

---

